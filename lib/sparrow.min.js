!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((n="undefined"!=typeof globalThis?globalThis:n||self).sp={})}(this,function(S){"use strict";function j(t,n){var r,e=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,r)),e}function an(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?j(Object(r),!0).forEach(function(n){g(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function P(n){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function g(n,t,r){t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r}function un(n,t){if(null==n)return{};var r,e=function(n,t){if(null==n)return{};for(var r,e={},o=Object.keys(n),i=0;i<o.length;i++)r=o[i],0<=t.indexOf(r)||(e[r]=n[r]);return e}(n,t);if(Object.getOwnPropertySymbols)for(var o=Object.getOwnPropertySymbols(n),i=0;i<o.length;i++)r=o[i],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(n,r)&&(e[r]=n[r]);return e}function cn(n,t){return I(n)||function(n,t){var r=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=r){var e,o,i=[],a=!0,u=!1;try{for(r=r.call(n);!(a=(e=r.next()).done)&&(i.push(e.value),!t||i.length!==t);a=!0);}catch(n){u=!0,o=n}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}}(n,t)||u(n,t)||C()}function fn(n){return function(n){if(Array.isArray(n))return e(n)}(n)||L(n)||u(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(n){if(Array.isArray(n))return n}function L(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}function u(n,t){if(n){if("string"==typeof n)return e(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);return"Map"===(r="Object"===r&&n.constructor?n.constructor.name:r)||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(n,t):void 0}}function e(n,t){(null==t||t>n.length)&&(t=n.length);for(var r=0,e=new Array(t);r<t;r++)e[r]=n[r];return e}function C(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ln(n,t){var r,e="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!e){if(Array.isArray(n)||(e=u(n))||t&&n&&"number"==typeof n.length)return e&&(n=e),r=0,{s:t=function(){},n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){e=e.call(n)},n:function(){var n=e.next();return i=n.done,n},e:function(n){a=!0,o=n},f:function(){try{i||null==e.return||e.return()}finally{if(a)throw o}}}}function W(n){n=function(n,t){if("object"!=typeof n||null===n)return n;var r=n[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(n);if("object"!=typeof(r=r.call(n,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(n,"string");return"symbol"==typeof n?n:String(n)}function E(n,t){for(var r,e=t.type,o=t.children,i=t.flex,i=void 0===i?o.map(function(){return 1}):i,t=t.padding,a=void 0===t?40:t,t=cn("col"===e?["y","height","width","x"]:["x","width","height","y"],4),u=t[0],c=t[1],f=t[2],l=t[3],d=i.reduce(function(n,t){return n+t}),s=n[c]-a*(o.length-1),v=i.map(function(n){return n/d*s}),y=[],h=n[u],p=0;p<v.length;h+=v[p]+a,p+=1)y.push((g(r={},u,h),g(r,c,v[p]),g(r,l,n[l]),g(r,f,n[f]),r));return y}function dn(n){return n}function sn(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return t.reduce(function(t,r){return function(n){return r(t(n))}},dn)}function n(i){var a=i.length;return function n(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];var o=0===r.length?[void 0]:r;return o.length>=a?i.apply(void 0,fn(o)):n.bind.apply(n,[null].concat(fn(o)))}}function D(n,t){return t*Math.ceil(n/t)}function R(n,t){return t*Math.floor(n/t)}function T(n,t){return Math.log(n)/Math.log(t)}function Y(n,t){var n=cn(n,2),r=n[0],n=n[1];return[t.floor(r),t.ceil(n)]}function vn(n,t){var e=1<arguments.length&&void 0!==t?t:dn;return Object.entries(n).reduce(function(n,t){var t=cn(t,2),r=t[0],t=t[1];return n[r]=e(t,r),n},{})}function hn(n,t){for(var r=0,e=Object.entries(t);r<e.length;r++){var o=cn(e[r],2),i=o[0],o=o[1];void 0!==o&&(n[i]=o)}}function X(n){return void 0!==n&&!Number.isNaN(n)}function q(n,t){var n=cn(n,2),r=n[0],n=n[1],t=cn(t,2),e=t[0],t=t[1];return i(r,e)&&i(n,t)}function i(n,t,r){r=2<arguments.length&&void 0!==r?r:1e-5;return Math.abs(n-t)<r}function s(n,t){var n=cn(n,2),r=n[0],n=n[1],t=cn(1<arguments.length&&void 0!==t?t:[],2),e=t[0],t=t[1],t=void 0===t?0:t;return Math.sqrt(Math.pow(r-(void 0===e?0:e),2)+Math.pow(n-t,2))}function b(n,t){var n=cn(n,2),r=n[0],n=n[1],t=cn(t,2);return[r-t[0],n-t[1]]}function F(n){var n=cn(n,2),t=n[0],n=n[1];return Math.atan2(n,t)}function B(n){return 180*n/Math.PI}function N(t,n,r){var e=1<arguments.length&&void 0!==n?n:function(n){return n[0]},o=2<arguments.length&&void 0!==r?r:function(n){return n[1]};return t.filter(function(r,n){return t.findIndex(function(n){return n=n,i(e(t=r),e(n))&&i(o(t),o(n));var t})===n})}function z(n,t){var r,e=1<arguments.length&&void 0!==t?t:function(n){return n},o=new Map,i=ln(n);try{for(i.s();!(r=i.n()).done;){var a=r.value,u=e(a),c=o.get(u);c?c.push(a):o.set(u,[a])}}catch(n){i.e(n)}finally{i.f()}return o}function f(n,t,r){var e=Math.sqrt(50),o=Math.sqrt(10),i=Math.sqrt(2),t=Math.abs(t-n)/Math.max(0,r),n=Math.pow(10,Math.floor(Math.log(t)/Math.LN10)),r=t/n;return e<=r?n*=10:o<=r?n*=5:i<=r&&(n*=2),n}function Z(n,t,r){if(n===t)return[n];for(var e,o=f(n,t,r),i=Math.ceil(n/o),r=Math.floor(t/o),a=Math.ceil(r-i+1),u=new Array(a),c=0;c<a;c+=1)u[c]=(e=(i+c)*o,Math.round(1e12*e)/1e12);return u}function U(n,t,r,e,o){for(var r=2<arguments.length&&void 0!==r?r:0,e=3<arguments.length&&void 0!==e?e:n.length,i=4<arguments.length&&void 0!==o?o:dn,a=r,u=e;a<u;){var c=a+u>>>1;i(n[c])<t?a=1+c:u=c}return a}function x(n){return n[n.length-1]}function pn(n,t){for(var r=[n];r.length;){var e=r.pop();t(e),r.push.apply(r,fn(e.children||[]))}}function l(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function _(n,t){n&&n.appendChild(t)}function J(e,n){for(var t=n.data,r=n.encodings,r=void 0===r?{}:r,o=n.padding,i=void 0===o?0:o,o=n.paddingLeft,a=void 0===o?45:o,o=n.paddingRight,u=void 0===o?45:o,o=n.paddingBottom,o=void 0===o?45:o,n=n.paddingTop,n=void 0===n?60:n,c=r.x,f=r.y,l=c?Array.from(z(t,function(n){return n[c]}).keys()):[void 0],d=f?Array.from(z(t,function(n){return n[f]}).keys()):[void 0],s=l.length,v=d.length,y=[],r=e.width-a-u,t=e.height-n-o,h=(r-i*(s-1))/s,p=(t-i*(v-1))/v,g=function(r){for(var n=function(t){y.push({x:a+e.x+i*r+r*h,y:u+e.y+i*t+t*p,width:h,height:p,transform:function(n){return n.filter(function(n){return(n[c]===l[r]||void 0===l[r])&&(n[f]===d[t]||void 0===d[t])})}})},t=0;t<v;t+=1)n(t)},m=0;m<s;m+=1)g(m);return y}function $(n,t){t=t.children;return new Array((void 0===t?[]:t).length).fill(0).map(function(){return an({},n)})}function gn(n,t){var r,e,o=1<arguments.length&&void 0!==t?t:{layer:$,col:E,row:E,facet:J},t=(r=[],pn(n,function(n){return r.push(n)}),r),i=n.width,a=n.height,u=n.x,c=n.y,f=new Map([[n,{width:void 0===i?640:i,height:void 0===a?480:a,x:void 0===u?0:u,y:void 0===c?0:c}]]),l=ln(t);try{for(l.s();!(e=l.n()).done;){var d=e.value,s=f.get(d),v=d.children,y=void 0===v?[]:v,h=o[d.type];if(h){var p=h(s,d);if(h!==J)for(var g=0,m=Object.entries(y);g<m.length;g++){var x=cn(m[g],2),b=x[0],w=x[1];f.set(w,p[b])}else{var k,A=ln(y);try{for(A.s();!(k=A.n()).done;){var M,O=k.value,S=ln(p);try{for(S.s();!(M=S.n()).done;){var j=M.value;f.set(an({},O),j)}}catch(n){S.e(n)}finally{S.f()}}}catch(n){A.e(n)}finally{A.f()}}}}}catch(n){l.e(n)}finally{l.f()}n=z(Array.from(f.entries()),function(n){var n=cn(n,2)[1];return"".concat((n=n).x,"-").concat(n.y,"-").concat(n.width,"-").concat(n.height)});return Array.from(n.values()).map(function(n){return[n[0][1],n.map(function(n){return n[0]})]})}var G=["text"];function H(n,t){return a("line",n,t)}function K(n,t){var r=t.width,e=t.height,o=t.x,i=t.y;return a("rect",n,an(an({},t),{},{width:Math.abs(r),height:Math.abs(e),x:0<r?o:o+r,y:0<e?i:i+e}))}function Q(n,t){var r=t.d,r=Array.isArray(r)?r.flat().join(" "):r;return a("path",n,an(an({},t),{},{d:r}))}function V(n,t){return a("circle",n,t)}function nn(n,t){var r=t.text,n=a("text",n,un(t,G));return n.textContent=r,n}function a(n,t,r){for(var t=t.group,n=l(n),e=n,o=0,i=Object.entries(r);o<i.length;o++){var a=cn(i[o],2),u=a[0],a=a[1],u=u.replace(/[A-Z]/g,function(n){return"-".concat(n.toLocaleLowerCase())});e.setAttribute(u,a)}return _(t,n),n}function tn(n,t){for(var r,t=t.group,e=arguments.length,o=new Array(2<e?e-2:0),i=2;i<e;i++)o[i-2]=arguments[i];t=t,n="".concat(n,"(").concat(o.join(", "),")"),r=(r=t.getAttribute("transform")||"")?"".concat(r," "):"",t.setAttribute("transform","".concat(r).concat(n))}function mn(n,t,r){var r=2<arguments.length&&void 0!==r?r:{},e=r.line,o=void 0===e?H:e,e=r.circle,i=void 0===e?V:e,e=r.text,a=void 0===e?nn:e,e=r.rect,u=void 0===e?K:e,e=r.path,c=void 0===e?Q:e,e=r.context,f=(void 0===e?function(n){return n}:e)((r=n,e=t,(n=l("svg")).setAttribute("width",r),n.setAttribute("height",e),n.setAttribute("viewBox","0 0 ".concat(r," ").concat(e)),r=l("g"),_(n,r),{node:n,group:r}));return{line:function(n){return o(f,n)},circle:function(n){return i(f,n)},text:function(n){return a(f,n)},rect:function(n){return u(f,n)},path:function(n){return c(f,n)},restore:function(){var n,t;t=(n=f).group.parentNode,n.group=t},save:function(){return t=(n=f).group,r=l("g"),_(t,r),void(n.group=r);var n,t,r},scale:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return function(n,t,r){tn("scale",n,t,r)}.apply(void 0,[f].concat(t))},rotate:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return function(n,t){tn("rotate",n,t)}.apply(void 0,[f].concat(t))},translate:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return function(n,t,r){tn("translate",n,t,r)}.apply(void 0,[f].concat(t))},node:function(){return f.node},group:function(){return f.group}}}var xn=["transforms"];function c(n,t){var r=0<arguments.length&&void 0!==n?n:0,e=1<arguments.length&&void 0!==t?t:0;return v("translate",function(n){var n=cn(n,2),t=n[0],n=n[1];return[t+r,n+e]})}function d(n,t){var r=0<arguments.length&&void 0!==n?n:1,e=1<arguments.length&&void 0!==t?t:1;return v("scale",function(n){var n=cn(n,2),t=n[0],n=n[1];return[t*r,n*e]})}function v(n,t){return t.type=function(){return n},t}var rn=n(function(n,t){var r=t.x,e=t.y;return[d(t.width,t.height),c(r,e)]});var en=n(function(n,t){var r=t.width,t=t.height,e=void 0===(e=n.innerRadius)?0:e,o=void 0===(o=n.outerRadius)?1:o,i=void 0===(i=n.startAngle)?-Math.PI/2:i,n=void 0===(n=n.endAngle)?Math.PI/2*3:n,t=1<(r=r/t)?1/r:1,r=1<r?1:r;return[c(0,-.5),v("reflectY",d(1,-1)),c(0,.5),d(n-i,o-e),c(i,e),v("polar",function(n){var n=cn(n,2),t=n[0],n=n[1];return[n*Math.cos(t),n*Math.sin(t)]}),d(t,r),d(.5,.5),c(.5,.5)]});var on=n(function(n,t){return[v("transpose",function(n){var n=cn(n,2),t=n[0];return[n[1],t]}),c(-.5,-.5),v("reflectX",d(-1,1)),c(.5,.5)]}),bn=["name","optional"];function t(n){var t=n.name,r=n.optional;return an({name:t,optional:void 0===r||r},un(n,bn))}function r(n){n=0<arguments.length&&void 0!==n?n:{};return an({x:t({name:"x",optional:!1}),y:t({name:"y",optional:!1}),stroke:t({name:"stroke"}),fill:t({name:"fill"})},n)}function w(n,t){var r=t.stroke,t=t.fill;return an(an({},r&&{stroke:r[n]}),t&&{fill:t[n]})}function wn(n,t){return w(cn(n,1)[0],t)}function y(n){var n=I(n=n)||L(n)||u(n)||C(),t=n[0],n=n.slice(1);return[["M"].concat(fn(t))].concat(fn(n.map(function(n){return["L"].concat(fn(n))})))}function kn(n){return[].concat(fn(y(n)),[["Z"]])}function An(n){var n=cn(n,5),t=n[0],r=n[1],e=n[2],o=n[3],n=n[4],i=s(t,r),a=s(t,o),u=(u=b(r,t),t=b(e,t),u=F(u),t=F(t),u<t?t-u:2*Math.PI-(u-t)),t=u>Math.PI?1:0,u=u>Math.PI?1:0;return[["M",r[0],r[1]],["A",i,i,0,t,1,e[0],e[1]],["L",o[0],o[1]],["A",a,a,0,u,0,n[0],n[1]],["Z"]]}var Mn=["cx","cy","r1","r2"],On=["points"];function Sn(n,t){var r,e,o,i,a,u,c=t.cx,f=t.cy,l=t.r1,d=t.r2,t=un(t,Mn),s=n.path(an(an({},t),{},{d:(e=(r=cn(r=[[c,f],[l,d]],2))[0],o=(r=cn(r[1],2))[0],r=r[1],i=(s=cn(e,2))[0],s=s[1],[].concat(fn(An([e,a=[i,s-r],r=[i,s+r],u=[i,s+o],i=[i,s-o]])),fn(An([e,r,a,i,u])))),stroke:"none"}));return[n.circle(an(an({},t),{},{fill:"none",r:l,cx:c,cy:f})),s,n.circle(an(an({},t),{},{fill:"none",r:d,cx:c,cy:f}))]}var jn=["x1","y1","x2","y2"],zn=["cx","cy","r"],Pn=["X","Y","I"],In=["X1","Y1","X2","Y2","I"],Ln=["x","y","rotate","text"],Cn=["x1","y1","x2","y2"];function Wn(n,t,r){var e=r.x1,o=r.y1,i=r.x2,a=r.y2,r=un(r,jn),u=[e,o],o=[i,o],i=[i,a],e=[e,a],a=(t.isTranspose()?[e,u,o,i]:[u,o,i,e]).map(t),u=cn(a,4),o=u[0],i=u[1],e=u[2],u=u[3];if(!t.isPolar())return l=(d=cn(b(e,o),2))[0],d=d[1],c=(f=cn(o,2))[0],f=f[1],n.rect(an({x:c,y:f,width:l,height:d},r));var c=t.center(),f=cn(c,2),l=f[0],d=f[1];return q(o,i)&&q(e,u)?Sn(n,an({cx:l,cy:d,r1:s(c,e),r2:s(c,o)},r)):n.path(an({d:An([c].concat(fn(a)))},r))}function En(n,t,r){var e,o,i,a,u,c,f=r.X1,l=r.Y1,d=r.X2,s=r.Y2,v=r.I,r=un(r,In),v=t.isPolar()?[].concat(fn(v),[v[0]]):v,v=[].concat(fn(v.map(function(n){return[f[n],l[n]]})),fn(v.map(function(n){return[d[n],s[n]]}).reverse())).map(t);return t.isPolar()?(t=n,e=an({points:v},r),o=e.points,e=un(e,On),i=o.length,a=i/2,u=t.path(an(an({d:kn(o)},e),{},{stroke:"none"})),c=t.path(an(an({d:y(o.slice(0,a))},e),{},{fill:"none"})),[t.path(an(an({d:y(o.slice(a,i))},e),{},{fill:"none"})),u,c]):n.path(an({d:kn(v)},r))}function o(d,s){function n(n,t,r,e,o,i){for(var a=0,u=Object.entries(d);a<u.length;a++){var c=cn(u[a],2),f=c[0],c=c[1],l=c.optional,c=c.scale;if(!l){if(!e[f])throw new Error("Missing Channel: ".concat(f));if(!("band"!==c||r[f]&&r[f].bandWidth))throw new Error("".concat(f," channel needs band scale."))}}return s(n,t,r,e,o,i)}return n.channels=function(){return d},n}var Dn=["z","x"];var Rn=o(r({x:t({name:"x",scale:"band",optional:!1}),z:t({name:"z",scale:"band"}),y1:t({name:"y1",optional:!1})}),function(o,n,t,i,a,u){var c={z:0,x:0},r=t.x,t=t.z,f=i.x,l=i.y,d=i.y1,s=void 0===(e=i.z)?[]:e,v=r.bandWidth(),e=t&&t.bandWidth?t.bandWidth():1,y=v*e;return Array.from(n,function(n){var t=c.z,r=c.x,e=un(c,Dn),t=(s[n]||t)*v,r=(f[n]||r)+t;return Wn(o,u,an(an(an(an({},e),a),w(n,i)),{},{x1:r,y1:l[n],x2:r+y,y2:d[n]}))})});var Tn=o(r({x:t({name:"x",scale:"band",optional:!1}),y:t({name:"y",scale:"band",optional:!1})}),function(t,n,r,e,o,i){var a={},u=r.x,r=r.y,c=e.x,f=e.y,l=u.bandWidth(),d=r.bandWidth();return Array.from(n,function(n){return Wn(t,i,an(an(an(an({},a),o),w(n,e)),{},{x1:c[n],y1:f[n],x2:c[n]+l,y2:f[n]+d}))})});var Yn=o(r({x1:t({name:"x1",optional:!1}),y1:t({name:"y1",optional:!1})}),function(t,n,r,e,o,i){var a={},u=e.x,c=e.y,f=e.x1,l=e.y1;return Array.from(n,function(n){return Wn(t,i,an(an(an(an({},a),o),w(n,e)),{},{x1:u[n],y1:c[n],x2:f[n],y2:l[n]}))})});var Xn=o(r({z:t({name:"z"})}),function(a,n,t,u,c,f){var l={},d=u.x,s=u.y,r=u.z,n=r?z(n,function(n){return r[n]}).values():[n];return Array.from(n,function(n){return t=a,r=f,n=an(an(an(an({},l),c),wn(n,u)),{},{X:d,Y:s,I:n,fill:"none"}),e=n.X,o=n.Y,i=n.I,n=un(n,Pn),i=y((r.isPolar()?[].concat(fn(i),[i[0]]):i).map(function(n){return r([e[n],o[n]])})),t.path(an({d:i},n));var t,r,e,o,i})}),qn=["r"];var Fn=o(r({r:t({name:"r"})}),function(a,n,t,u,c,f){var l={r:3,fill:"none"},d=u.x,s=u.y,r=u.r,v=void 0===r?[]:r;return Array.from(n,function(n){var t,r,e,o=l.r,i=un(l,qn),o=v[n]||o;return t=a,r=f,i=an(an(an(an({},i),c),w(n,u)),{},{cx:d[n],cy:s[n],r:o}),n=i.cx,o=i.cy,e=i.r,i=un(i,zn),n=(r=cn(r([n,o]),2))[0],o=r[1],t.circle(an({cx:n,cy:o,r:e},i))})});var Bn=o(r({x1:t({name:"x1",optional:!1}),y1:t({name:"y1",optional:!1}),z:t({name:"z"})}),function(t,n,r,e,o,i){var a={},u=e.x,c=e.y,f=e.z,l=e.x1,d=e.y1,n=f?z(n,function(n){return f[n]}).values():[n];return Array.from(n,function(n){return En(t,i,an(an(an(an({},a),o),wn(n,e)),{},{X1:u,Y1:c,X2:l,Y2:d,I:n}))})});var Nn=o(r({rotate:t({name:"rotate"}),fontSize:t({name:"fontSize"}),fontWeight:t({name:"fontWeight"}),text:t({name:"text",optional:!1,scale:"identity"})}),function(u,n,t,c,f,l){var d=0,s=14,v="normal",y=c.x,h=c.y,p=c.text,r=c.rotate,g=void 0===r?[]:r,m=void 0===(r=c.fontSize)?[]:r,x=void 0===(r=c.fontWeight)?[]:r;return Array.from(n,function(n){return t=u,r=l,n=an(an(an({},f),w(n,c)),{},{x:y[n],y:h[n],rotate:g[n]||d,fontSize:m[n]||s,fontWeight:x[n]||v,text:p[n]}),e=n.x,o=n.y,i=n.rotate,a=n.text,n=un(n,Ln),e=(r=cn(r([e,o]),2))[0],o=r[1],t.save(),t.translate(e,o),t.rotate(i),r=t.text(an({text:a,x:0,y:0},n)),t.restore(),r;var t,r,e,o,i,a})});var Zn=o(r({x1:t({name:"x1",optional:!1}),y1:t({name:"y1",optional:!1})}),function(u,n,t,c,f,l){var d={},s=c.x,v=c.y,y=c.x1,h=c.y1;return Array.from(n,function(n){return t=u,r=l,n=an(an(an(an({},d),f),w(n,c)),{},{x1:s[n],y1:v[n],x2:y[n],y2:h[n]}),e=n.x1,o=n.y1,i=n.x2,a=n.y2,n=un(n,Cn),o=(e=cn([[e,o],[i,a]].map(r),2))[0],i=e[1],t.line(an({x1:o[0],y1:o[1],x2:i[0],y2:i[1]},n));var t,r,e,o,i,a})});var Un=o({d:t({name:"d",optional:!1,scale:"identity"}),fill:t({name:"fill"}),stroke:t({name:"stroke"})},function(r,n,t,e,o,i){var a={},u=e.d;return Array.from(n,function(n){return t=r,n=an(an(an(an({},a),o),w(n,e)),{},{d:u[n]}),t.path(n);var t})});function p(n,t,r){return t*(1-n)+r*n}function _n(n,t,r){var t=cn(Jn(t),3),e=t[0],o=t[1],t=t[2],r=cn(Jn(r),3),i=r[0],a=r[1],r=r[2],e=p(n,e,i),i=p(n,o,a),o=p(n,t,r),a=parseInt(e),n=parseInt(i),t=parseInt(o);return a=(a<<16|n<<8|t).toString(16),"#".concat(new Array(Math.abs(a.length-7)).join("0")).concat(a)}function Jn(n){for(var t=[],r=1;r<7;r+=2)t.push(parseInt("0x".concat(n.slice(r,r+2))));return t}function m(n){function t(n){return u((n-e)/(o-e),i,a)}var r=cn(n.domain,2),e=r[0],o=r[1],r=cn(n.range,2),i=r[0],a=r[1],r=n.interpolate,u=void 0===r?p:r;return t.ticks=function(){return Z(e,o,0<arguments.length&&void 0!==arguments[0]?arguments[0]:10)},t.nice=function(){var t,n;e!==o&&(t=f(e,o,0<arguments.length&&void 0!==arguments[0]?arguments[0]:10),n=cn(Y([e,o],{floor:function(n){return R(n,t)},ceil:function(n){return D(n,t)}}),2),e=n[0],o=n[1])},t}function $n(n){var t=n.domain,r=n.range,e=JSON.stringify,o=new Map(t.map(function(n,t){return[e(n),t]}));return function(n){n=o.get(e(n));return r[n%r.length]}}function Gn(n){i=(t=n).domain,a=t.range,f=t.padding,t=t.margin,r=void 0===t?f:t,t=cn(a,2),e=t[0],a=t[1],t=i.length;var t,r,e,o,i={step:o=(a-e)/(2*r+t-f),bandWidth:o*(1-f),bandRange:new Array(t).fill(0).map(function(n,t){return e+r*o+o*t})},a=i.bandRange,u=i.bandWidth,c=i.step,f=$n(an(an({},n),{},{range:a}));return f.bandWidth=function(){return u},f.step=function(){return c},f}function Hn(n){function t(n){return n=U(r,n),e[-1===n?o:n]}var r=n.domain,e=n.range,o=Math.min(r.length,e.length-1);return t.thresholds=function(){return r},t}var Kn=["domain","range"];var Qn=["domain","range"];var Vn=["domain"];function nt(n){function t(n){return n.getTime()}function r(n){return o(t(n))}var e=n.domain,n=un(n,Vn),o=m(an({domain:e.map(t)},n));return r.nice=function(n){return o.nice(n)},r.ticks=function(n){return o.ticks(n).map(function(n){return new Date(n)})},r}var tt=["domain","base"];function rt(n){function t(n){return Math.log(n)}function r(n){return u(t(n))}var e=n.domain,o=n.base,i=void 0===o?Math.E:o,a=un(n,tt),u=m(an({domain:e.map(t)},a));return r.ticks=function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:5,t=cn(e.map(function(n){return T(n,i)}),2);return Z(t[0],t[1],n).map(function(n){return Math.pow(i,n)})},r.nice=function(){e=Y(e,{floor:function(n){return Math.pow(i,Math.floor(T(n,i)))},ceil:function(n){return Math.pow(i,Math.ceil(T(n,i)))}}),u=m(an({domain:e.map(t)},a))},r}function et(m){return function(n,r,e,t){var o,i,a,u,c,f,l,d,s=t.domain,v=t.label,y=t.tickCount,y=void 0===y?10:y,h=t.formatter,p=void 0===h?dn:h,h=t.tickLength,h=void 0===h?5:h,g=t.grid,g=void 0!==g&&g,t=t.tick,t=void 0===t||t;0!==s.length&&(o=!!r.bandWidth,u=!!r.ticks,i=o?r.bandWidth()/2:0,a=u?r.ticks(y):s,u=e.center(),y="".concat(+e.isPolar()).concat(+e.isTranspose()),s={tickLength:h,fontSize:10,center:u,isOrdinal:o},u=(h=m[y]).grid,y=h.ticks,c=h.label,f=h.start,h=h.end,l=a.map(function(n){var t=cn(e(f(n,r,i)),2);return{x:t[0],y:t[1],text:p(n)}}),d=function(){if(!o)return x(l);var n=x(a),n=cn(e(f(n,r,2*i)),2);return{x:n[0],y:n[1]}}(),g&&u&&u(n,l,h(e)),t&&y&&y(n,l,s),v&&c&&c(n,v,d,s))}}function ot(n,t,r){var e,o=r.tickLength,i=r.fontSize,a=ln(t);try{for(a.s();!(e=a.n()).done;){var u=e.value,c=u.x,f=u.y,l=u.text,d=f+o;n.line({x1:c,y1:f,x2:c,y2:d,stroke:"currentColor",class:"tick"}),n.text({text:l,fontSize:i,x:c,y:d,textAnchor:"middle",dy:"1em",class:"text"})}}catch(n){a.e(n)}finally{a.f()}}function h(n,t,r){var e,o=r.tickLength,i=r.fontSize,a=ln(t);try{for(a.s();!(e=a.n()).done;){var u=e.value,c=u.x,f=u.y,l=u.text,d=c-o;n.line({x1:c,y1:f,x2:d,y2:f,stroke:"currentColor",class:"tick"}),n.text({text:l,fontSize:i,x:d,y:f,textAnchor:"end",dy:"0.5em",dx:"-0.5em",class:"text"})}}catch(n){a.e(n)}finally{a.f()}}function it(n,t,r){var e,o,i,a,u=r.tickLength,c=r.fontSize,f=r.center,l=ln(N(t,function(n){return n.x},function(n){return n.y}));try{for(l.s();!(e=l.n()).done;){var d=e.value,s=d.x,v=d.y,y=d.text,h=(o=f,void 0,a=void 0,i=cn(i=[s,v],2),a=i[0],i=i[1],a=F(b([a,i],o)),i=a<0?Math.PI:0,{tickRotation:a-Math.PI/2,textRotation:i}),p=h.tickRotation,g=h.textRotation,m=u,x=0===g?"1.2em":"-0.5em";n.save(),n.translate(s,v),n.rotate(B(p)),n.line({x1:0,y1:0,x2:0,y2:m,stroke:"currentColor",fill:"currentColor",class:"tick"}),n.save(),n.translate(0,m),n.rotate(B(g)),n.text({text:"".concat(y),x:0,y:0,textAnchor:"middle",fontSize:c,fill:"currentColor",dy:x,class:"text"}),n.restore(),n.restore()}}catch(n){l.e(n)}finally{l.f()}}function at(n,t,r){var e,o=cn(r,2)[1],i=ln(t);try{for(i.s();!(e=i.n()).done;){var a=e.value,u=a.x,c=a.y;n.line({x1:u,y1:c,x2:u,y2:o,stroke:"#eee",class:"grid"})}}catch(n){i.e(n)}finally{i.f()}}function ut(n,t,r){var e,o=cn(r,1)[0],i=ln(t);try{for(i.s();!(e=i.n()).done;){var a=e.value,u=a.x,c=a.y;n.line({x1:u,y1:c,x2:o,y2:c,stroke:"#eee",class:"grid"})}}catch(n){i.e(n)}finally{i.f()}}function ct(n,t,r){var e,r=cn(r,2),o=r[0],i=r[1],a=ln(t);try{for(a.s();!(e=a.n()).done;){var u=e.value,c=u.x,f=u.y;n.line({x1:c,y1:f,x2:o,y2:i,stroke:"#eee",class:"grid"})}}catch(n){a.e(n)}finally{a.f()}}function ft(n,t,r){var e,o=cn(r,2),i=o[0],a=o[1],u=ln(t);try{for(u.s();!(e=u.n()).done;){var c=e.value,f=s(r,[c.x,c.y]);n.circle({fill:"none",stroke:"#eee",cx:i,cy:a,r:f,class:"grid"})}}catch(n){u.e(n)}finally{u.f()}}var lt=["isOrdinal"],dt=["isOrdinal"],st=["isOrdinal","tickLength"],vt=["isOrdinal","tickLength"];function k(n){return{textAnchor:"end",class:"label",fontWeight:"bold",fontSize:n.fontSize}}var yt=et({"00":{start:function(n,t,r){return[t(n)+r,1]},end:function(n){return n([0,0])},grid:at,ticks:ot,label:function(n,t,r,e){var o=r.x,r=r.y,i=e.isOrdinal,a=e.tickLength,e=un(e,st),r=r+a,a=i?t:"".concat(t," →");n.text(an(an({},k(e)),{},{text:a,x:o,y:r,dy:"2.2em"}))}},"01":{start:function(n,t,r){return[t(n)+r,1]},end:function(n){return n([0,0])},grid:ut,ticks:h,label:function(n,t,r,e){var o=r.x,r=r.y,i=e.isOrdinal,e=un(e,dt),i=i?t:"↓ ".concat(t);n.text(an(an({},k(e)),{},{text:i,x:o,y:r,dy:"2.2em"}))}},10:{start:function(n,t,r){return[t(n)+r,0]},grid:ct,ticks:it,end:function(n){return n.center()}},11:{start:function(n,t,r){return[t(n)+r,1]},grid:ft,ticks:h,end:function(n){return n.center()}}}),ht=et({"00":{start:function(n,t,r){return[0,t(n)+r]},end:function(n){return n([1,0])},grid:ut,ticks:h,label:function(n,t,r,e){var o=r.x,r=r.y,i=e.isOrdinal,e=un(e,lt),i=i?t:"↑ ".concat(t);n.text(an(an({},k(e)),{},{text:i,x:o,y:r,dy:"-1em"}))}},"01":{start:function(n,t,r){return[0,t(n)+r]},end:function(n){return n([1,0])},grid:at,ticks:function(n,t,r){var e,o=r.tickLength,i=r.fontSize,a=ln(t);try{for(a.s();!(e=a.n()).done;){var u=e.value,c=u.x,f=u.y,l=u.text,d=f-o;n.line({x1:c,y1:f,x2:c,y2:d,stroke:"currentColor",class:"tick"}),n.text({text:l,fontSize:i,x:c,y:d,textAnchor:"middle",dy:"-0.3em",class:"text"})}}catch(n){a.e(n)}finally{a.f()}},label:function(n,t,r,e){var o=r.x,r=r.y,i=e.isOrdinal,a=e.tickLength,e=un(e,vt),r=r-a,a=i?t:"".concat(t," →");n.text(an(an({},k(e)),{},{text:a,x:o,y:r,dy:"-1.2em"}))}},10:{start:function(n,t,r){return[0,t(n)+r]},grid:ft,ticks:h,end:function(n){return n.center()}},11:{start:function(n,t,r){return[0,t(n)+r]},grid:ct,ticks:it,end:function(n){return n.center()}}});function pt(n,t,r,e){for(var o=e.x,i=e.y,a=e.width,u=void 0===a?64:a,a=e.marginLeft,c=void 0===a?6:a,a=e.swatchSize,f=void 0===a?10:a,a=e.fontSize,l=void 0===a?10:a,a=e.formatter,d=void 0===a?dn:a,a=e.domain,e=e.label,s=(n.save(),n.translate(o,i),e&&n.text({text:e,x:0,y:0,fontWeight:"bold",fontSize:l,textAnchor:"start",dy:"1em"}),e?2*f:0),v=0,y=Object.entries(a);v<y.length;v++){var h=cn(y[v],2),p=h[0],h=h[1],g=t(h),p=u*p,g=(n.rect({x:p,y:s,width:f,height:f,stroke:g,fill:g}),p+c+f),p=s+f;n.text({text:d(h),x:g,y:p,fill:"currentColor",fontSize:l})}n.restore()}function gt(n,t,r,e){for(var o=e.x,i=e.y,a=e.width,u=void 0===a?120:a,a=e.height,c=void 0===a?10:a,a=e.domain,f=e.tickCount,f=void 0===f?5:f,l=e.tickLength,l=void 0===l?c+5:l,d=e.formatter,s=void 0===d?dn:d,d=e.fontSize,d=void 0===d?10:d,e=e.label,v=(n.save(),n.translate(o,i),e&&n.text({text:e,x:0,y:0,fontWeight:"bold",fontSize:d,textAnchor:"start",dy:"1em"}),e?2*c:0),o=[a[0],x(a)],y=m({domain:[0,u],range:o}),h=0;h<u;h+=1){var p=t(y(h));n.line({x1:h,y1:v,x2:h,y2:v+c,stroke:p})}var g=m({domain:o,range:[0,u]});ot(n,(t.thresholds?[o[0]].concat(fn(t.thresholds()),[o[1]]):g.ticks(f)).map(function(n){return{x:g(n),y:v,text:s(n)}}),{fontSize:d,tickLength:l}),n.restore()}function mt(n,t,r){var t=1<arguments.length&&void 0!==t?t:10,r=2<arguments.length&&void 0!==r?r:dn,e=(e=n,o=r,Math.min.apply(Math,fn(e.map(o)))),r=(o=n,n=r,Math.max.apply(Math,fn(o.map(n)))),o=f(e,r,t),n=R(e,o),e=D(r,o),r=f(n,e,t),o=Z(n,e,t);return Array.from(new Set([R(n,r)].concat(fn(o),[D(e,r)])))}var xt=["type"];function yn(n){if("function"==typeof n)return n;var t,o,i,r,e,a,u,c,f,l=n.type,d=un(n,xt);if("interval"===l)return Rn;if("line"===l)return Xn;if("area"===l)return Bn;if("text"===l)return Nn;if("link"===l)return Zn;if("cell"===l)return Tn;if("rect"===l)return Yn;if("point"===l)return Fn;if("path"===l)return Un;if("facet"===l)return(t=function(){}).channels=function(){return{x:{name:"x",optional:!0},y:{name:"y",optional:!0}}},t;if("stackY"===l)return function(n){var t,r=n.index,n=n.values,e=n.y,o=n.x,i=o?Array.from(z(r,function(n){return o[n]}).values()):[r],a=new Array(r.length),u=new Array(r.length),c=ln(i);try{for(c.s();!(t=c.n()).done;)for(var f=t.value,l=0,d=0;d<f.length;l=a[f[d]],d+=1){var s=f[d];u[s]=l,a[s]=l+e[s]}}catch(n){c.e(n)}finally{c.f()}return{index:r,values:an(an({},n),{},{y:a,y1:u})}};if("normalizeY"===l)return function(n){var t,r=n.index,e=n.values,o=e.x,n=o?Array.from(z(r,function(n){return o[n]}).values()):[r],i=Object.fromEntries(["y1","y"].filter(function(n){return e[n]}).map(function(n){return[n,new Array(r.length)]})),a=ln(n);try{for(a.s();!(t=a.n()).done;){var u,c=t.value,f=c.flatMap(function(t){return Object.keys(i).map(function(n){return e[n][t]})}),l=Math.max.apply(Math,fn(f)),d=ln(c);try{for(d.s();!(u=d.n()).done;)for(var s=u.value,v=0,y=Object.keys(i);v<y.length;v++){var h=y[v];i[h][s]=e[h][s]/l}}catch(n){d.e(n)}finally{d.f()}}}catch(n){a.e(n)}finally{a.f()}return{index:r,values:an(an({},e),i)}};if("symmetryY"===l)return function(n){for(var t=n.index,r=n.values,e=r.x,n=e?Array.from(z(t,function(n){return e[n]}).values()):[t],o=Object.fromEntries(["y1","y"].filter(function(n){return r[n]}).map(function(n){return[n,new Array(t.length)]})),i=new Array(n.length),a=0,u=Object.entries(n);a<u.length;a++){var c=cn(u[a],2),f=c[0],c=c[1].flatMap(function(t){return Object.keys(o).map(function(n){return r[n][t]})}),l=Math.min.apply(Math,fn(c)),c=Math.max.apply(Math,fn(c));i[f]=(l+c)/2}for(var d=Math.max.apply(Math,i),s=0,v=Object.entries(n);s<v.length;s++){var y,h=cn(v[s],2),p=h[0],h=h[1],g=d-i[p],m=ln(h);try{for(m.s();!(y=m.n()).done;)for(var x=y.value,b=0,w=Object.keys(o);b<w.length;b++){var k=w[b];o[k][x]=r[k][x]+g}}catch(n){m.e(n)}finally{m.f()}}return{index:t,values:an(an({},r),o)}};if("binX"===l)return function(n){var n=0<arguments.length&&void 0!==n?n:{},t=n.count,c=void 0===t?10:t,f=n.channel,l=void 0===(t=n.aggregate)?function(n){return n.length}:t;return function(n){var t=n.index,r=n.values,e=(r[f],r.x),n=(r.x1,un(r,[f,"x","x1"].map(W))),n=Object.keys(n),o=mt(e,c),i=o.length,a=z(t,function(n){return U(o,e[n])-1}),u=new Array(i-1).fill(0).map(function(n,t){return t});return{index:u.filter(function(n){return a.has(n)}),values:Object.fromEntries([].concat(fn(n.map(function(t){return[t,u.map(function(n){if(a.has(n))return r[t][a.get(n)[0]]})]})),[[f,u.map(function(n){return a.has(n)?l(a.get(n).map(function(n){return r[n]})):0})],["x",o.slice(0,i-1)],["x1",o.slice(1,i)]]))}}}(d);if("cartesian"===l)return rn(d);if("transpose"===l)return on(d);if("polar"===l)return en(d);if("band"===l)return Gn(d);if("linear"===l)return bt(m,d);if("time"===l)return bt(nt,d);if("log"===l)return bt(rt,d);if("identity"===l)return function(n){return n};if("ordinal"===l)return $n(d);if("dot"===l)return Gn(an(an({},d),{},{padding:1}));if("quantile"===l)return r=(t=d).domain,e=d.range,t=un(d,Kn),a=e.length-1,o=r.sort(function(n,t){return n-t}),i=(o.length-1)/(1+a),Hn(an({domain:new Array(a).fill(0).map(function(n,t){var t=(t+1)*i,r=Math.floor(t),e=r+1;return o[r]*(e-t)+o[e]*(t-r)}),range:e},t));if("quantize"===l)return e=(a=cn((r=d).domain,2))[0],a=a[1],u=r.range,r=un(r,Qn),c=u.length-1,f=(a-e)/(1+c),Hn(an({domain:new Array(c).fill(0).map(function(n,t){return f*(t+1)}),range:u},r));if("threshold"===l)return Hn(d);if("axisX"===l)return A(yt,d);if("axisY"===l)return A(ht,d);if("legendSwatches"===l)return A(pt,d);if("legendRamp"===l)return A(gt,d);throw new Error("Unknown node type: ".concat(n.type))}function A(e,o){return function(n,t,r){return e(n,t,r,o)}}function bt(n,t){var r=t.nice,r=void 0===r||r,e=t.tickCount,e=void 0===e?10:e,n=n(t);return r&&n.nice(e),n}var wt=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],kt=["#9DF5CA","#61DDAA","#42C090","#19A576","#008A5D"],At=["domain"];function Mt(n,t){var r,e,o,i,a,u,c,f={},l=ln(z(n.flatMap(Object.entries),function(n){return Ot(cn(n,1)[0])}));try{for(l.s();!(r=l.n()).done;){var d=cn(r.value,2),s=d[0],v=function(n,t){var r,e,o,i=[],a=ln(t);try{for(a.s();!(o=a.n()).done;){var u=cn(o.value,2)[1],c=u.values,f=void 0===c?[]:c,l=u.scale,d=u.field;i.push.apply(i,fn(f)),!r&&l&&(r=l),!e&&d&&(e=d)}}catch(n){a.e(n)}finally{a.f()}return{name:n,scale:r,values:i,field:e}}(s,d[1]),y=t[s]||{},h=(o=y,c=u=a=i=void 0,i=(e=v).name,a=e.scale,e=e.values,u=y.type,c=y.domain,o=y.range,a||u||(2<(c||o||[]).length?St(i):void 0===c?jt(e)?St(i):zt(e)?"time":function(n){return 1===Array.from(new Set(n)).length}(e)?"identity":"linear":jt(c)?St(i):zt(c)?"time":"linear"));f[s]=an(an(an({},y),function(n,t,r){var e=t.name,o=r.padding,i=r.interpolate,a=r.margin;switch(n){case"linear":case"log":return i?{interpolate:i}:{interpolate:"color"===e?_n:p};case"band":return{padding:void 0!==o?o:.1};case"dot":return{margin:void 0!==a?a:.5};default:return{}}}(h,v,y)),{},{domain:function(n,t,r){var e=t.values,t=r.domain,o=un(r,At);if(t)return t;switch(n){case"linear":case"log":case"quantize":return Pt(e,o);case"ordinal":case"dot":case"band":return It(e);case"quantile":return function(n){return It(n).sort()}(e);case"time":return function(n,t){return Pt(n,t).map(function(n){return new Date(n)})}(e,o);default:return[]}}(h,v,y),range:function(n,t,r){var e=t.name,t=r.range;if(t)return t;switch(n){case"linear":case"log":case"time":case"band":case"dot":return function(n){return"y"===n?[1,0]:"color"===n?[kt[0],x(kt)]:[0,1]}(e);case"ordinal":return wt;case"quantile":case"quantize":case"threshold":return kt;default:return[]}}(h,v,y),label:function(n,t){n=n.field,t=t.label;return void 0!==t?t:n}(v,y),type:h})}}catch(n){l.e(n)}finally{l.f()}return f}function Ot(n){return n.startsWith("x")?"x":n.startsWith("y")?"y":"fill"===(t=n)||"stroke"===t?"color":n;var t}function St(n){return"x"===(n=n)||"y"===n?"dot":"ordinal"}function jt(n){return n.some(function(n){n=P(n);return"string"===n||"boolean"===n})}function zt(n){return n.some(function(n){return n instanceof Date})}function Pt(n,t){t=(1<arguments.length&&void 0!==t?t:{}).zero,t=void 0!==t&&t,n=n.filter(X);if(0===n.length)return[];var r=Math.min.apply(Math,fn(n));return[t?0:r,Math.max.apply(Math,fn(n))]}function It(n){return Array.from(new Set(n.filter(X)))}var Lt=["fill"],Ct=["stroke"],Wt=["y1"],Et=["x1"],Dt=["y"],Rt=["x"],Tt=["x","x1"],Yt=["fill","stroke","z"];function Xt(n,r,t){var e,o,i,a,u=vn(t,function(n,t){return{type:function(n,t,r){if("function"==typeof t)return"transform";if("string"==typeof t){if(n.length&&void 0!==n[0][t])return"field";if(function(n){return"fill"===n||"stroke"===n}(r))return"constant"}return"value"}(r,n,t),value:n}});switch(n){case"interval":return M((i=Ft(u),a=void 0===(a=i.x)?O():a,i=un(i,Rt),an({x:a},i)));case"line":return qt(Nt(u));case"area":return M(Bt(Ft(Nt(u))));case"link":return qt(Bt(u));case"point":return a=qt(u),i=void 0===(i=a.y)?O():i,a=un(a,Dt),an({y:i},a);case"rect":return M((e=Ft(u),o=void 0===(o=e.x1)?O():o,e=un(e,Et),an({x1:o},e)));case"cell":return M(u)}return u}function M(n){var t=n.fill;return an({fill:void 0===t?Ut():t},un(n,Lt))}function qt(n){var t=n.stroke;return an({stroke:void 0===t?Ut():t},un(n,Ct))}function Ft(n){var t=n.y1;return an({y1:void 0===t?O():t},un(n,Wt))}function Bt(n){var t=n.x,r=n.x1;return an({x:t,x1:void 0===r?t:r},un(n,Tt))}function Nt(n){var t=n.fill,r=n.stroke,e=n.z,n=un(n,Yt);return an({fill:t,stroke:r,z:e=void 0===(e=void 0===e?Zt(t):e)?Zt(r):e},n)}function Zt(n){if(void 0!==n&&"field"===n.type)return n}function O(){return{type:"value",value:0}}function Ut(){return{type:"constant",value:wt[0]}}function _t(n){for(var t=n.data,r=n.type,e=n.encodings,e=void 0===e?{}:e,o=n.statistics,o=void 0===o?[]:o,i=n.transforms,i=void 0===i?[]:i,n=n.styles,a=sn.apply(void 0,fn(i.map(yn)))(t),i=a.map(function(n,t){return t}),u=Xt(r,a,e),c={},f={},l=0,d=Object.entries(u);l<d.length;l++){var s,v,y=cn(d[l],2),h=y[0],y=y[1];y&&(s=y.type,v=y.value,"constant"===s?c[h]=v:f[h]=function(n,t){var r=t.type,e=t.value;return"transform"===r?n.map(e):"value"===r?n.map(function(){return e}):n.map(function(n){return n[e]})}(a,y))}for(var t=sn.apply(void 0,fn(o.map(yn)))({index:i,values:f}),p=t.values,e=t.index,o=yn({type:r}),g={},m=0,x=Object.entries(o.channels());m<x.length;m++){var b=cn(x[m],2),w=b[0],b=b[1],k=p[w],A=b.optional;if(k)g[w]=function(n,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},e=r.type,r=r.value;return an(an(an({},n),"field"===e&&{field:r}),{},{values:t})}(b,k,u[w]);else if(!A)throw new Error("Missing values for channel: ".concat(w))}return{index:e,geometry:o,channels:g,styles:an(an({},n),c)}}function Jt(n,t,r){var e=n.x,o=n.y,n=n.color,i=r.x,i=void 0===i?{}:i,a=r.y,a=void 0===a?{}:a,r=r.color,r=void 0===r?{}:r,u=i.display,c=a.display,c=void 0===c||c,f=r.display,f=void 0===f||f;return an(an(an({},(void 0===u||u)&&e&&{x:an(an({},$t(i,e)),{},{type:"axisX"})}),c&&o&&{y:an(an({},$t(a,o)),{},{type:"axisY"})}),f&&n&&{color:an(an(an({},$t(r,n)),(i=(u=t).x,e=t.y,u=t.paddingLeft,{x:i+u,y:e})),{},{type:function(n){switch(n.type){case"linear":case"log":case"time":case"threshold":case"quantile":case"quantize":return"legendRamp";default:return"legendSwatches"}}(n)})})}function $t(n,t){var r=t.domain,t=t.label;return an(an({},n),{},{domain:r,label:t})}var Gt=["transform"],Ht=["scales","guides","coordinates","transforms","paddingLeft","paddingRight","paddingBottom","paddingTop"],Kt=["type","children"];function Qt(n){switch(n){case"layer":case"col":case"row":return!1;default:return!0}}S.plot=function(n){var t,r=n.width,e=n.height,o=mn(void 0===r?640:r,void 0===e?480:e,n.renderer),r=(pn(n,function(n){var t=n.type,r=n.children,e=un(n,Kt);if(!Qt(t)&&r&&0!==r.length){var o,i=["o:encodings","o:scales","o:guides","o:styles","a:coordinates","a:statistics","a:transforms","a:data"],a=ln(r);try{for(a.s();!(o=a.n()).done;){var u,c=o.value,f=ln(i);try{for(f.s();!(u=f.n()).done;){var l=cn(u.value.split(":"),2),d=l[0],s=l[1];c[s]="o"===d?an(an({},e[s]),c[s]):c[s]||e[s]}}catch(n){f.e(n)}finally{f.f()}}}catch(n){a.e(n)}finally{a.f()}}}),gn(n)),i=ln(r);try{for(i.s();!(t=i.n()).done;){var a,u=cn(t.value,2),c=u[0],R=u[1],f=c.transform,T=void 0===f?dn:f,l=un(c,Gt),d=[],s={},v={},y=[],h=ln(R.filter(function(n){return Qt(n.type)}));try{for(h.s();!(a=h.n()).done;){var p=a.value,Y=p.scales,X=void 0===Y?{}:Y,q=p.guides,F=void 0===q?{}:q,B=p.coordinates,N=void 0===B?[]:B,Z=p.transforms,U=void 0===Z?[]:Z,_=p.paddingLeft,J=p.paddingRight,$=p.paddingBottom,G=p.paddingTop,H=un(p,Ht);hn(s,X),hn(v,F),hn(l,{paddingLeft:_,paddingRight:J,paddingBottom:$,paddingTop:G}),N&&(y=N),d.push(an(an({},H),{},{transforms:[T].concat(fn(U))}))}}catch(n){h.e(n)}finally{h.f()}on=en=rn=tn=nn=D=W=E=C=L=C=L=I=P=z=x=m=j=x=m=b=S=S=O=O=M=M=A=A=k=w=V=Q=b=K=x=m=g=S=void 0;for(var g=(S=an({renderer:o,scales:s,guides:v,geometries:d,coordinates:y},l)).renderer,m=S.scales,x=S.guides,K=S.coordinates,b=S.geometries,Q=S.width,V=S.height,w=S.x,k=S.y,A=void 0===(A=S.paddingLeft)?45:A,M=void 0===(M=S.paddingRight)?45:M,O=void 0===(O=S.paddingBottom)?45:O,S=void 0===(S=S.paddingTop)?65:S,b=b.map(_t),x=Jt(m=Mt(b.map(function(n){return n.channels}),m),{x:w,y:k,paddingLeft:A},x),j=vn(m,yn),m=vn(x,yn),x=function(n){return[].concat(fn(n),[{type:"cartesian"}])}(K).map(yn),z=function(n){var t=void 0===(t=n.transforms)?[]:t,r=un(n,xn),e=(n=t.flatMap(function(n){return n(r)})).map(function(n){return n.type()}),t=sn.apply(void 0,fn(n)),o=r.x,i=r.y,a=r.width,u=r.height;return t.isPolar=function(){return-1!==e.indexOf("polar")},t.isTranspose=function(){return e.reduce(function(n,t){return n^"transpose"===t},!1)},t.center=function(){return[o+a/2,i+u/2]},t}({x:w+A,y:k+S,width:Q-A-M,height:V-S-O,transforms:x}),P=0,I=Object.entries(m);P<I.length;P++){var L=cn(I[P],2),C=L[0],L=L[1],C=j[C];L(g,C,z)}var W,E=ln(b);try{for(E.s();!(W=E.n()).done;){var D=W.value,nn=D.index,tn=D.geometry,rn=D.channels,en=D.styles,on=function(n,r){return vn(n,function(n){var t=n.values,n=n.name,n=r[Ot(n)];return t.map(n)})}(rn,j);tn(g,nn,j,on,en,z)}}catch(n){E.e(n)}finally{E.f()}}}catch(n){i.e(n)}finally{i.f()}return o.node()},Object.defineProperty(S,"__esModule",{value:!0})});
