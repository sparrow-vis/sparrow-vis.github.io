!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((n="undefined"!=typeof globalThis?globalThis:n||self).sp={})}(this,function(n){"use strict";function e(t,n){var r,e=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,r)),e}function C(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach(function(n){g(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function t(n){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function g(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function W(n,t){if(null==n)return{};var r,e=function(n,t){if(null==n)return{};for(var r,e={},o=Object.keys(n),i=0;i<o.length;i++)r=o[i],0<=t.indexOf(r)||(e[r]=n[r]);return e}(n,t);if(Object.getOwnPropertySymbols)for(var o=Object.getOwnPropertySymbols(n),i=0;i<o.length;i++)r=o[i],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(n,r)&&(e[r]=n[r]);return e}function E(n,t){return r(n)||function(n,t){var r=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=r){var e,o,i=[],a=!0,u=!1;try{for(r=r.call(n);!(a=(e=r.next()).done)&&(i.push(e.value),!t||i.length!==t);a=!0);}catch(n){u=!0,o=n}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}}(n,t)||u(n,t)||a()}function D(n){return function(n){if(Array.isArray(n))return i(n)}(n)||o(n)||u(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(n){if(Array.isArray(n))return n}function o(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}function u(n,t){if(n){if("string"==typeof n)return i(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);return"Map"===(r="Object"===r&&n.constructor?n.constructor.name:r)||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(n,t):void 0}}function i(n,t){(null==t||t>n.length)&&(t=n.length);for(var r=0,e=new Array(t);r<t;r++)e[r]=n[r];return e}function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function R(n,t){var r="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!r){if(Array.isArray(n)||(r=u(n))||t&&n&&"number"==typeof n.length){r&&(n=r);var e=0,t=function(){};return{s:t,n:function(){return e>=n.length?{done:!0}:{done:!1,value:n[e++]}},e:function(n){throw n},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){r=r.call(n)},n:function(){var n=r.next();return i=n.done,n},e:function(n){a=!0,o=n},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function d(n){n=function(n,t){if("object"!=typeof n||null===n)return n;var r=n[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(n);if("object"!=typeof(t=r.call(n,t||"default")))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}(n,"string");return"symbol"==typeof n?n:String(n)}function z(n,t){for(var r,e=t.type,o=t.children,i=t.flex,i=void 0===i?o.map(function(){return 1}):i,t=t.padding,a=void 0===t?40:t,e=E("col"===e?["y","height","width","x"]:["x","width","height","y"],4),u=e[0],c=e[1],f=e[2],l=e[3],d=i.reduce(function(n,t){return n+t}),s=n[c]-a*(o.length-1),v=i.map(function(n){return n/d*s}),y=[],h=n[u],p=0;p<v.length;h+=v[p]+a,p+=1)y.push((g(r={},u,h),g(r,c,v[p]),g(r,l,n[l]),g(r,f,n[f]),r));return y}function T(n){return n}function Y(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return t.reduce(function(t,r){return function(n){return r(t(n))}},T)}function c(i){var a=i.length;return function n(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];var o=0===r.length?[void 0]:r;return o.length>=a?i.apply(void 0,D(o)):n.bind.apply(n,[null].concat(D(o)))}}function f(n,t){return t*Math.ceil(n/t)}function l(n,t){return t*Math.floor(n/t)}function s(n,t){return Math.log(n)/Math.log(t)}function v(n,t){var r=E(n,2),n=r[0],r=r[1];return[t.floor(n),t.ceil(r)]}function X(n,t){var e=1<arguments.length&&void 0!==t?t:T;return Object.entries(n).reduce(function(n,t){var r=E(t,2),t=r[0],r=r[1];return n[t]=e(r,t),n},{})}function q(n,t){for(var r=0,e=Object.entries(t);r<e.length;r++){var o=E(e[r],2),i=o[0],o=o[1];void 0!==o&&(n[i]=o)}}function y(n){return void 0!==n&&!Number.isNaN(n)}function h(n,t){var r=E(n,2),e=r[0],n=r[1],r=E(t,2),t=r[0],r=r[1];return p(e,t)&&p(n,r)}function p(n,t,r){r=2<arguments.length&&void 0!==r?r:1e-5;return Math.abs(n-t)<r}function m(n,t){var r=E(n,2),e=r[0],n=r[1],r=E(1<arguments.length&&void 0!==t?t:[],2),t=r[0],r=r[1],r=void 0===r?0:r;return Math.sqrt(Math.pow(e-(void 0===t?0:t),2)+Math.pow(n-r,2))}function b(n,t){var r=E(n,2),n=r[0],r=r[1],t=E(t,2);return[n-t[0],r-t[1]]}function w(n){var t=E(n,2),n=t[0],t=t[1];return Math.atan2(t,n)}function k(n){return 180*n/Math.PI}function A(t,n,r){var e=1<arguments.length&&void 0!==n?n:function(n){return n[0]},o=2<arguments.length&&void 0!==r?r:function(n){return n[1]};return t.filter(function(r,n){return t.findIndex(function(n){return t=n,p(e(n=r),e(t))&&p(o(n),o(t));var t})===n})}function P(n,t){var r,e=1<arguments.length&&void 0!==t?t:function(n){return n},o=new Map,i=R(n);try{for(i.s();!(r=i.n()).done;){var a=r.value,u=e(a),c=o.get(u);c?c.push(a):o.set(u,[a])}}catch(n){i.e(n)}finally{i.f()}return o}function x(n,t,r){var e=Math.sqrt(50),o=Math.sqrt(10),i=Math.sqrt(2),n=Math.abs(t-n)/Math.max(0,r),r=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),n=n/r;return e<=n?r*=10:o<=n?r*=5:i<=n&&(r*=2),r}function M(n,t,r){if(n===t)return[n];for(var e,o=x(n,t,r),i=Math.ceil(n/o),t=Math.floor(t/o),a=Math.ceil(t-i+1),u=new Array(a),c=0;c<a;c+=1)u[c]=(e=(i+c)*o,Math.round(1e12*e)/1e12);return u}function O(n,t,r,e,o){for(var r=2<arguments.length&&void 0!==r?r:0,e=3<arguments.length&&void 0!==e?e:n.length,i=4<arguments.length&&void 0!==o?o:T,a=r,u=e;a<u;){var c=a+u>>>1;i(n[c])<t?a=1+c:u=c}return a}function S(n){return n[n.length-1]}function F(n,t){for(var r=[n];r.length;){var e=r.pop();t(e),r.push.apply(r,D(e.children||[]))}}function j(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function I(n,t){n&&n.appendChild(t)}function L(e,n){for(var t=n.data,r=n.encodings,o=void 0===r?{}:r,r=n.padding,i=void 0===r?0:r,r=n.paddingLeft,a=void 0===r?45:r,r=n.paddingRight,u=void 0===r?45:r,r=n.paddingBottom,r=void 0===r?45:r,n=n.paddingTop,n=void 0===n?60:n,c=o.x,f=o.y,l=c?Array.from(P(t,function(n){return n[c]}).keys()):[void 0],d=f?Array.from(P(t,function(n){return n[f]}).keys()):[void 0],s=l.length,v=d.length,y=[],t=e.width-a-u,r=e.height-n-r,h=(t-i*(s-1))/s,p=(r-i*(v-1))/v,g=function(r){for(var n=function(t){y.push({x:a+e.x+i*r+r*h,y:u+e.y+i*t+t*p,width:h,height:p,transform:function(n){return n.filter(function(n){return(n[c]===l[r]||void 0===l[r])&&(n[f]===d[t]||void 0===d[t])})}})},t=0;t<v;t+=1)n(t)},m=0;m<s;m+=1)g(m);return y}function B(n,t){t=t.children;return new Array((void 0===t?[]:t).length).fill(0).map(function(){return C({},n)})}function N(n,t){var r,e,o=1<arguments.length&&void 0!==t?t:{layer:B,col:z,row:z,facet:L},i=(r=[],F(n,function(n){return r.push(n)}),r),a=n.width,u=n.height,c=n.x,t=n.y,f=new Map([[n,{width:void 0===a?640:a,height:void 0===u?480:u,x:void 0===c?0:c,y:void 0===t?0:t}]]),l=R(i);try{for(l.s();!(e=l.n()).done;){var d=e.value,s=f.get(d),v=d.children,y=void 0===v?[]:v,h=o[d.type];if(h){var p=h(s,d);if(h!==L)for(var g=0,m=Object.entries(y);g<m.length;g++){var x=E(m[g],2),b=x[0],w=x[1];f.set(w,p[b])}else{var k,A=R(y);try{for(A.s();!(k=A.n()).done;){var M,O=k.value,S=R(p);try{for(S.s();!(M=S.n()).done;){var j=M.value;f.set(C({},O),j)}}catch(n){S.e(n)}finally{S.f()}}}catch(n){A.e(n)}finally{A.f()}}}}}catch(n){l.e(n)}finally{l.f()}i=P(Array.from(f.entries()),function(n){var n=E(n,2)[1];return"".concat((n=n).x,"-").concat(n.y,"-").concat(n.width,"-").concat(n.height)});return Array.from(i.values()).map(function(n){return[n[0][1],n.map(function(n){return n[0]})]})}var Z=["text"];function U(n,t){return H("line",n,t)}function _(n,t){var r=t.width,e=t.height,o=t.x,i=t.y;return H("rect",n,C(C({},t),{},{width:Math.abs(r),height:Math.abs(e),x:0<r?o:o+r,y:0<e?i:i+e}))}function J(n,t){var r=t.d,r=Array.isArray(r)?r.flat().join(" "):r;return H("path",n,C(C({},t),{},{d:r}))}function $(n,t){return H("circle",n,t)}function G(n,t){var r=t.text,t=H("text",n,W(t,Z));return t.textContent=r,t}function H(n,t,r){t=t.group,n=j(n);return function(n,t){for(var r=0,e=Object.entries(t);r<e.length;r++){var o=E(e[r],2),i=o[0],o=o[1],i=i.replace(/[A-Z]/g,function(n){return"-".concat(n.toLocaleLowerCase())});n.setAttribute(i,o)}}(n,r),I(t,n),n}function K(n,t){for(var r=t.group,e=arguments.length,o=new Array(2<e?e-2:0),i=2;i<e;i++)o[i-2]=arguments[i];t=r,r="".concat(n,"(").concat(o.join(", "),")"),n=(n=t.getAttribute("transform")||"")?"".concat(n," "):"",t.setAttribute("transform","".concat(n).concat(r))}function Q(n,t,r){var e=2<arguments.length&&void 0!==r?r:{},r=e.line,o=void 0===r?U:r,r=e.circle,i=void 0===r?$:r,r=e.text,a=void 0===r?G:r,r=e.rect,u=void 0===r?_:r,r=e.path,c=void 0===r?J:r,e=e.context,f=(void 0===e?function(n){return n}:e)((e=n,n=t,(t=j("svg")).setAttribute("width",e),t.setAttribute("height",n),t.setAttribute("viewBox","0 0 ".concat(e," ").concat(n)),n=j("g"),I(t,n),{node:t,group:n}));return{line:function(n){return o(f,n)},circle:function(n){return i(f,n)},text:function(n){return a(f,n)},rect:function(n){return u(f,n)},path:function(n){return c(f,n)},restore:function(){var n,t;t=(n=f).group.parentNode,n.group=t},save:function(){return t=(n=f).group,r=j("g"),I(t,r),void(n.group=r);var n,t,r},scale:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return function(n,t,r){K("scale",n,t,r)}.apply(void 0,[f].concat(t))},rotate:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return function(n,t){K("rotate",n,t)}.apply(void 0,[f].concat(t))},translate:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return function(n,t,r){K("translate",n,t,r)}.apply(void 0,[f].concat(t))},node:function(){return f.node},group:function(){return f.group}}}var V=["transforms"];function nn(n,t){var r=0<arguments.length&&void 0!==n?n:0,e=1<arguments.length&&void 0!==t?t:0;return rn("translate",function(n){var t=E(n,2),n=t[0],t=t[1];return[n+r,t+e]})}function tn(n,t){var r=0<arguments.length&&void 0!==n?n:1,e=1<arguments.length&&void 0!==t?t:1;return rn("scale",function(n){var t=E(n,2),n=t[0],t=t[1];return[n*r,t*e]})}function rn(n,t){return t.type=function(){return n},t}var en=c(function(n,t){var r=t.x,e=t.y;return[tn(t.width,t.height),nn(r,e)]});var on=c(function(n,t){var r=t.width,e=t.height,o=void 0===(i=n.innerRadius)?0:i,i=void 0===(t=n.outerRadius)?1:t,t=void 0===(t=n.startAngle)?-Math.PI/2:t,n=void 0===(n=n.endAngle)?Math.PI/2*3:n,e=1<(r=r/e)?1/r:1,r=1<r?1:r;return[nn(0,-.5),rn("reflectY",tn(1,-1)),nn(0,.5),tn(n-t,i-o),nn(t,o),rn("polar",function(n){var t=E(n,2),n=t[0],t=t[1];return[t*Math.cos(n),t*Math.sin(n)]}),tn(e,r),tn(.5,.5),nn(.5,.5)]});var an=c(function(n,t){return[rn("transpose",function(n){var t=E(n,2),n=t[0];return[t[1],n]}),nn(-.5,-.5),rn("reflectX",tn(-1,1)),nn(.5,.5)]}),un=["name","optional"];function cn(n){var t=n.name,r=n.optional;return C({name:t,optional:void 0===r||r},W(n,un))}function fn(n){n=0<arguments.length&&void 0!==n?n:{};return C({x:cn({name:"x",optional:!1}),y:cn({name:"y",optional:!1}),stroke:cn({name:"stroke"}),fill:cn({name:"fill"})},n)}function ln(n,t){var r=t.stroke,t=t.fill;return C(C({},r&&{stroke:r[n]}),t&&{fill:t[n]})}function dn(n,t){return ln(E(n,1)[0],t)}function sn(n){var n=r(t=n)||o(t)||u(t)||a(),t=n[0],n=n.slice(1);return[["M"].concat(D(t))].concat(D(n.map(function(n){return["L"].concat(D(n))})))}function vn(n){return[].concat(D(sn(n)),[["Z"]])}function yn(n){var t=E(n,5),r=t[0],e=t[1],o=t[2],i=t[3],a=t[4],u=m(r,e),n=m(r,i),t=(t=b(e,r),r=b(o,r),t=w(t),r=w(r),t<r?r-t:2*Math.PI-(t-r)),r=t>Math.PI?1:0,t=t>Math.PI?1:0;return[["M",e[0],e[1]],["A",u,u,0,r,1,o[0],o[1]],["L",i[0],i[1]],["A",n,n,0,t,0,a[0],a[1]],["Z"]]}var hn=["cx","cy","r1","r2"],pn=["points"];function gn(n,t){var r,e,o,i,a,u=t.cx,c=t.cy,f=t.r1,l=t.r2,d=W(t,hn),s=n.path(C(C({},d),{},{d:(e=(a=E(r=[[u,c],[f,l]],2))[0],o=E(a[1],2),i=o[0],s=o[1],t=E(e,2),r=t[0],a=t[1],[].concat(D(yn([e,o=[r,a-s],t=[r,a+s],s=[r,a+i],i=[r,a-i]])),D(yn([e,t,o,i,s])))),stroke:"none"}));return[n.circle(C(C({},d),{},{fill:"none",r:f,cx:u,cy:c})),s,n.circle(C(C({},d),{},{fill:"none",r:l,cx:u,cy:c}))]}var mn=["x1","y1","x2","y2"],xn=["cx","cy","r"],bn=["X","Y","I"],wn=["X1","Y1","X2","Y2","I"],kn=["x","y","rotate","text"],An=["x1","y1","x2","y2"];function Mn(n,t,r){var e=r.x1,o=r.y1,i=r.x2,a=r.y2,u=W(r,mn),c=[e,o],f=[i,o],r=[i,a],o=[e,a],i=(t.isTranspose()?[o,c,f,r]:[c,f,r,o]).map(t),e=E(i,4),a=e[0],c=e[1],f=e[2],r=e[3];if(!t.isPolar()){var o=E(b(f,a),2),l=o[0],d=o[1],e=E(a,2),o=e[0],e=e[1];return n.rect(C({x:o,y:e,width:l,height:d},u))}l=t.center(),d=E(l,2),t=d[0],d=d[1];return h(a,c)&&h(f,r)?gn(n,C({cx:t,cy:d,r1:m(l,f),r2:m(l,a)},u)):n.path(C({d:yn([l].concat(D(i)))},u))}function On(n,t,r){var e,o,i,a=r.X1,u=r.Y1,c=r.X2,f=r.Y2,l=r.I,d=W(r,wn),s=t.isPolar()?[].concat(D(l),[l[0]]):l,v=[].concat(D(s.map(function(n){return[a[n],u[n]]})),D(s.map(function(n){return[c[n],f[n]]}).reverse())).map(t);return t.isPolar()?(e=n,o=C({points:v},d),i=o.points,r=W(o,pn),l=i.length,s=l/2,t=e.path(C(C({d:vn(i)},r),{},{stroke:"none"})),o=e.path(C(C({d:sn(i.slice(0,s))},r),{},{fill:"none"})),[e.path(C(C({d:sn(i.slice(s,l))},r),{},{fill:"none"})),t,o]):n.path(C({d:vn(v)},d))}function Sn(d,s){function n(n,t,r,e,o,i){for(var a=0,u=Object.entries(d);a<u.length;a++){var c=E(u[a],2),f=c[0],l=c[1],c=l.optional,l=l.scale;if(!c){if(!e[f])throw new Error("Missing Channel: ".concat(f));if(!("band"!==l||r[f]&&r[f].bandWidth))throw new Error("".concat(f," channel needs band scale."))}}return s(n,t,r,e,o,i)}return n.channels=function(){return d},n}var jn=["z","x"];var zn=Sn(fn({x:cn({name:"x",scale:"band",optional:!1}),z:cn({name:"z",scale:"band"}),y1:cn({name:"y1",optional:!1})}),function(o,n,t,i,a,u){var c={z:0,x:0},r=t.x,e=t.z,f=i.x,l=i.y,d=i.y1,s=void 0===(t=i.z)?[]:t,v=r.bandWidth(),e=e&&e.bandWidth?e.bandWidth():1,y=v*e;return Array.from(n,function(n){var t=c.z,r=c.x,e=W(c,jn),t=(s[n]||t)*v,t=(f[n]||r)+t;return Mn(o,u,C(C(C(C({},e),a),ln(n,i)),{},{x1:t,y1:l[n],x2:t+y,y2:d[n]}))})});var Pn=Sn(fn({x:cn({name:"x",scale:"band",optional:!1}),y:cn({name:"y",scale:"band",optional:!1})}),function(t,n,r,e,o,i){var a={},u=r.x,r=r.y,c=e.x,f=e.y,l=u.bandWidth(),d=r.bandWidth();return Array.from(n,function(n){return Mn(t,i,C(C(C(C({},a),o),ln(n,e)),{},{x1:c[n],y1:f[n],x2:c[n]+l,y2:f[n]+d}))})});var In=Sn(fn({x1:cn({name:"x1",optional:!1}),y1:cn({name:"y1",optional:!1})}),function(t,n,r,e,o,i){var a={},u=e.x,c=e.y,f=e.x1,l=e.y1;return Array.from(n,function(n){return Mn(t,i,C(C(C(C({},a),o),ln(n,e)),{},{x1:u[n],y1:c[n],x2:f[n],y2:l[n]}))})});var Ln=Sn(fn({z:cn({name:"z"})}),function(a,n,t,u,c,f){var l={},d=u.x,s=u.y,r=u.z,n=r?P(n,function(n){return r[n]}).values():[n];return Array.from(n,function(n){return t=a,r=f,e=C(C(C(C({},l),c),dn(n,u)),{},{X:d,Y:s,I:n,fill:"none"}),o=e.X,i=e.Y,n=e.I,e=W(e,bn),n=sn((r.isPolar()?[].concat(D(n),[n[0]]):n).map(function(n){return r([o[n],i[n]])})),t.path(C({d:n},e));var t,r,e,o,i})}),Cn=["r"];var Wn=Sn(fn({r:cn({name:"r"})}),function(a,n,t,u,c,f){var l={r:3,fill:"none"},d=u.x,s=u.y,r=u.r,v=void 0===r?[]:r;return Array.from(n,function(n){var t,r,e=l.r,o=W(l,Cn),i=v[n]||e;return t=a,r=f,e=C(C(C(C({},o),c),ln(n,u)),{},{cx:d[n],cy:s[n],r:i}),o=e.cx,n=e.cy,i=e.r,e=W(e,xn),n=(o=E(r([o,n]),2))[0],o=o[1],t.circle(C({cx:n,cy:o,r:i},e))})});var En=Sn(fn({x1:cn({name:"x1",optional:!1}),y1:cn({name:"y1",optional:!1}),z:cn({name:"z"})}),function(t,n,r,e,o,i){var a={},u=e.x,c=e.y,f=e.z,l=e.x1,d=e.y1,n=f?P(n,function(n){return f[n]}).values():[n];return Array.from(n,function(n){return On(t,i,C(C(C(C({},a),o),dn(n,e)),{},{X1:u,Y1:c,X2:l,Y2:d,I:n}))})});var Dn=Sn(fn({rotate:cn({name:"rotate"}),fontSize:cn({name:"fontSize"}),fontWeight:cn({name:"fontWeight"}),text:cn({name:"text",optional:!1,scale:"identity"})}),function(u,n,t,c,f,l){var d=0,s=14,v="normal",y=c.x,h=c.y,p=c.text,r=c.rotate,g=void 0===r?[]:r,m=void 0===(r=c.fontSize)?[]:r,x=void 0===(r=c.fontWeight)?[]:r;return Array.from(n,function(n){return t=u,r=l,e=C(C(C({},f),ln(n,c)),{},{x:y[n],y:h[n],rotate:g[n]||d,fontSize:m[n]||s,fontWeight:x[n]||v,text:p[n]}),o=e.x,i=e.y,a=e.rotate,n=e.text,e=W(e,kn),i=(o=E(r([o,i]),2))[0],o=o[1],t.save(),t.translate(i,o),t.rotate(a),e=t.text(C({text:n,x:0,y:0},e)),t.restore(),e;var t,r,e,o,i,a})});var Rn=Sn(fn({x1:cn({name:"x1",optional:!1}),y1:cn({name:"y1",optional:!1})}),function(u,n,t,c,f,l){var d={},s=c.x,v=c.y,y=c.x1,h=c.y1;return Array.from(n,function(n){return t=u,r=l,e=C(C(C(C({},d),f),ln(n,c)),{},{x1:s[n],y1:v[n],x2:y[n],y2:h[n]}),o=e.x1,i=e.y1,a=e.x2,n=e.y2,e=W(e,An),r=(n=E([[o,i],[a,n]].map(r),2))[0],n=n[1],t.line(C({x1:r[0],y1:r[1],x2:n[0],y2:n[1]},e));var t,r,e,o,i,a})});var Tn=Sn({d:cn({name:"d",optional:!1,scale:"identity"}),fill:cn({name:"fill"}),stroke:cn({name:"stroke"})},function(r,n,t,e,o,i){var a={},u=e.d;return Array.from(n,function(n){return t=r,n=C(C(C(C({},a),o),ln(n,e)),{},{d:u[n]}),t.path(n);var t})});function Yn(n,t,r){return t*(1-n)+r*n}function Xn(n,t,r){var e=E(qn(t),3),o=e[0],i=e[1],a=e[2],t=E(qn(r),3),e=t[0],r=t[1],t=t[2],e=Yn(n,o,e),r=Yn(n,i,r),t=Yn(n,a,t);return function(n,t,r){r=(n<<16|t<<8|r).toString(16);return"#".concat(new Array(Math.abs(r.length-7)).join("0")).concat(r)}(parseInt(e),parseInt(r),parseInt(t))}function qn(n){for(var t=[],r=1;r<7;r+=2)t.push(parseInt("0x".concat(n.slice(r,r+2))));return t}function Fn(n){function t(n){return u((n-e)/(o-e),i,a)}var r=E(n.domain,2),e=r[0],o=r[1],r=E(n.range,2),i=r[0],a=r[1],n=n.interpolate,u=void 0===n?Yn:n;return t.ticks=function(){return M(e,o,0<arguments.length&&void 0!==arguments[0]?arguments[0]:10)},t.nice=function(){var t,n;e!==o&&(t=x(e,o,0<arguments.length&&void 0!==arguments[0]?arguments[0]:10),n=E(v([e,o],{floor:function(n){return l(n,t)},ceil:function(n){return f(n,t)}}),2),e=n[0],o=n[1])},t}function Bn(n){var t=n.domain,r=n.range,e=JSON.stringify,o=new Map(t.map(function(n,t){return[e(n),t]}));return function(n){n=o.get(e(n));return r[n%r.length]}}function Nn(n){var t,r,e,o,i,a=(u=(t=n).domain,r=t.range,a=t.padding,t=t.margin,e=void 0===t?a:t,r=E(r,2),o=r[0],r=r[1],u=u.length,{step:i=(r-o)/(2*e+u-a),bandWidth:i*(1-a),bandRange:new Array(u).fill(0).map(function(n,t){return o+e*i+i*t})}),u=a.bandRange,c=a.bandWidth,f=a.step,u=Bn(C(C({},n),{},{range:u}));return u.bandWidth=function(){return c},u.step=function(){return f},u}function Zn(n){function t(n){return n=O(r,n),e[-1===n?o:n]}var r=n.domain,e=n.range,o=Math.min(r.length,e.length-1);return t.thresholds=function(){return r},t}var Un=["domain","range"];var _n=["domain","range"];var Jn=["domain"];function $n(n){function t(n){return n.getTime()}function r(n){return o(t(n))}var e=n.domain,n=W(n,Jn),o=Fn(C({domain:e.map(t)},n));return r.nice=function(n){return o.nice(n)},r.ticks=function(n){return o.ticks(n).map(function(n){return new Date(n)})},r}var Gn=["domain","base"];function Hn(n){function t(n){return Math.log(n)}function r(n){return u(t(n))}var e=n.domain,o=n.base,i=void 0===o?Math.E:o,a=W(n,Gn),u=Fn(C({domain:e.map(t)},a));return r.ticks=function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:5,t=E(e.map(function(n){return s(n,i)}),2);return M(t[0],t[1],n).map(function(n){return Math.pow(i,n)})},r.nice=function(){e=v(e,{floor:function(n){return Math.pow(i,Math.floor(s(n,i)))},ceil:function(n){return Math.pow(i,Math.ceil(s(n,i)))}}),u=Fn(C({domain:e.map(t)},a))},r}function Kn(m){return function(n,r,e,t){var o,i,a,u,c,f=t.domain,l=t.label,d=t.tickCount,s=void 0===d?10:d,v=t.formatter,y=void 0===v?T:v,h=t.tickLength,p=void 0===h?5:h,g=t.grid,d=void 0!==g&&g,v=t.tick,h=void 0===v||v;0!==f.length&&(o=!!r.bandWidth,g=!!r.ticks,i=o?r.bandWidth()/2:0,a=g?r.ticks(s):f,t=e.center(),v="".concat(+e.isPolar()).concat(+e.isTranspose()),g={tickLength:p,fontSize:10,center:t,isOrdinal:o},f=(s=m[v]).grid,p=s.ticks,t=s.label,u=s.start,v=s.end,c=a.map(function(n){var t=E(e(u(n,r,i)),2);return{x:t[0],y:t[1],text:y(n)}}),s=function(){if(!o)return S(c);var n=S(a),n=E(e(u(n,r,2*i)),2);return{x:n[0],y:n[1]}}(),d&&f&&f(n,c,v(e)),h&&p&&p(n,c,g),l&&t&&t(n,l,s,g))}}function Qn(n,t,r){var e,o=r.tickLength,i=r.fontSize,a=R(t);try{for(a.s();!(e=a.n()).done;){var u=e.value,c=u.x,f=u.y,l=u.text,d=f+o;n.line({x1:c,y1:f,x2:c,y2:d,stroke:"currentColor",class:"tick"}),n.text({text:l,fontSize:i,x:c,y:d,textAnchor:"middle",dy:"1em",class:"text"})}}catch(n){a.e(n)}finally{a.f()}}function Vn(n,t,r){var e,o=r.tickLength,i=r.fontSize,a=R(t);try{for(a.s();!(e=a.n()).done;){var u=e.value,c=u.x,f=u.y,l=u.text,d=c-o;n.line({x1:c,y1:f,x2:d,y2:f,stroke:"currentColor",class:"tick"}),n.text({text:l,fontSize:i,x:d,y:f,textAnchor:"end",dy:"0.5em",dx:"-0.5em",class:"text"})}}catch(n){a.e(n)}finally{a.f()}}function nt(n,t,r){var e,o,i,a,u=r.tickLength,c=r.fontSize,f=r.center,l=R(A(t,function(n){return n.x},function(n){return n.y}));try{for(l.s();!(e=l.n()).done;){var d=e.value,s=d.x,v=d.y,y=d.text,h=(o=f,void 0,void 0,a=void 0,i=(a=E(i=[s,v],2))[0],a=a[1],a=w(b([i,a],o)),o=a<0?Math.PI:0,{tickRotation:a-Math.PI/2,textRotation:o}),p=h.tickRotation,g=h.textRotation,m=u,x=0===g?"1.2em":"-0.5em";n.save(),n.translate(s,v),n.rotate(k(p)),n.line({x1:0,y1:0,x2:0,y2:m,stroke:"currentColor",fill:"currentColor",class:"tick"}),n.save(),n.translate(0,m),n.rotate(k(g)),n.text({text:"".concat(y),x:0,y:0,textAnchor:"middle",fontSize:c,fill:"currentColor",dy:x,class:"text"}),n.restore(),n.restore()}}catch(n){l.e(n)}finally{l.f()}}function tt(n,t,r){var e,o=E(r,2)[1],i=R(t);try{for(i.s();!(e=i.n()).done;){var a=e.value,u=a.x,c=a.y;n.line({x1:u,y1:c,x2:u,y2:o,stroke:"#eee",class:"grid"})}}catch(n){i.e(n)}finally{i.f()}}function rt(n,t,r){var e,o=E(r,1)[0],i=R(t);try{for(i.s();!(e=i.n()).done;){var a=e.value,u=a.x,c=a.y;n.line({x1:u,y1:c,x2:o,y2:c,stroke:"#eee",class:"grid"})}}catch(n){i.e(n)}finally{i.f()}}function et(n,t,r){var e,r=E(r,2),o=r[0],i=r[1],a=R(t);try{for(a.s();!(e=a.n()).done;){var u=e.value,c=u.x,f=u.y;n.line({x1:c,y1:f,x2:o,y2:i,stroke:"#eee",class:"grid"})}}catch(n){a.e(n)}finally{a.f()}}function ot(n,t,r){var e,o=E(r,2),i=o[0],a=o[1],u=R(t);try{for(u.s();!(e=u.n()).done;){var c=e.value,f=m(r,[c.x,c.y]);n.circle({fill:"none",stroke:"#eee",cx:i,cy:a,r:f,class:"grid"})}}catch(n){u.e(n)}finally{u.f()}}var it=["isOrdinal"],at=["isOrdinal"],ut=["isOrdinal","tickLength"],ct=["isOrdinal","tickLength"];function ft(n){return{textAnchor:"end",class:"label",fontWeight:"bold",fontSize:n.fontSize}}var lt=Kn({"00":{start:function(n,t,r){return[t(n)+r,1]},end:function(n){return n([0,0])},grid:tt,ticks:Qn,label:function(n,t,r,e){var o=r.x,i=r.y,a=e.isOrdinal,r=e.tickLength,e=W(e,ut),r=i+r,t=a?t:"".concat(t," →");n.text(C(C({},ft(e)),{},{text:t,x:o,y:r,dy:"2.2em"}))}},"01":{start:function(n,t,r){return[t(n)+r,1]},end:function(n){return n([0,0])},grid:rt,ticks:Vn,label:function(n,t,r,e){var o=r.x,i=r.y,r=e.isOrdinal,e=W(e,at),t=r?t:"↓ ".concat(t);n.text(C(C({},ft(e)),{},{text:t,x:o,y:i,dy:"2.2em"}))}},10:{start:function(n,t,r){return[t(n)+r,0]},grid:et,ticks:nt,end:function(n){return n.center()}},11:{start:function(n,t,r){return[t(n)+r,1]},grid:ot,ticks:Vn,end:function(n){return n.center()}}}),dt=Kn({"00":{start:function(n,t,r){return[0,t(n)+r]},end:function(n){return n([1,0])},grid:rt,ticks:Vn,label:function(n,t,r,e){var o=r.x,i=r.y,r=e.isOrdinal,e=W(e,it),t=r?t:"↑ ".concat(t);n.text(C(C({},ft(e)),{},{text:t,x:o,y:i,dy:"-1em"}))}},"01":{start:function(n,t,r){return[0,t(n)+r]},end:function(n){return n([1,0])},grid:tt,ticks:function(n,t,r){var e,o=r.tickLength,i=r.fontSize,a=R(t);try{for(a.s();!(e=a.n()).done;){var u=e.value,c=u.x,f=u.y,l=u.text,d=f-o;n.line({x1:c,y1:f,x2:c,y2:d,stroke:"currentColor",class:"tick"}),n.text({text:l,fontSize:i,x:c,y:d,textAnchor:"middle",dy:"-0.3em",class:"text"})}}catch(n){a.e(n)}finally{a.f()}},label:function(n,t,r,e){var o=r.x,i=r.y,a=e.isOrdinal,r=e.tickLength,e=W(e,ct),r=i-r,t=a?t:"".concat(t," →");n.text(C(C({},ft(e)),{},{text:t,x:o,y:r,dy:"-1.2em"}))}},10:{start:function(n,t,r){return[0,t(n)+r]},grid:ot,ticks:Vn,end:function(n){return n.center()}},11:{start:function(n,t,r){return[0,t(n)+r]},grid:et,ticks:nt,end:function(n){return n.center()}}});function st(n,t,r,e){var o=e.x,i=e.y,a=e.width,u=void 0===a?64:a,a=e.marginLeft,c=void 0===a?6:a,a=e.swatchSize,f=void 0===a?10:a,a=e.fontSize,l=void 0===a?10:a,a=e.formatter,d=void 0===a?T:a,a=e.domain,e=e.label;n.save(),n.translate(o,i),e&&n.text({text:e,x:0,y:0,fontWeight:"bold",fontSize:l,textAnchor:"start",dy:"1em"});for(var s=e?2*f:0,v=0,y=Object.entries(a);v<y.length;v++){var h=E(y[v],2),p=h[0],g=h[1],h=t(g),p=u*p;n.rect({x:p,y:s,width:f,height:f,stroke:h,fill:h});h=p+c+f,p=s+f;n.text({text:d(g),x:h,y:p,fill:"currentColor",fontSize:l})}n.restore()}function vt(n,t,r,e){var o=e.x,i=e.y,a=e.width,u=void 0===a?120:a,c=e.height,f=void 0===c?10:c,l=e.domain,d=e.tickCount,a=void 0===d?5:d,c=e.tickLength,d=void 0===c?f+5:c,c=e.formatter,s=void 0===c?T:c,c=e.fontSize,c=void 0===c?10:c,e=e.label;n.save(),n.translate(o,i),e&&n.text({text:e,x:0,y:0,fontWeight:"bold",fontSize:c,textAnchor:"start",dy:"1em"});for(var v=e?2*f:0,l=[l[0],S(l)],y=Fn({domain:[0,u],range:l}),h=0;h<u;h+=1){var p=t(y(h));n.line({x1:h,y1:v,x2:h,y2:v+f,stroke:p})}var g=Fn({domain:l,range:[0,u]});Qn(n,(t.thresholds?[l[0]].concat(D(t.thresholds()),[l[1]]):g.ticks(a)).map(function(n){return{x:g(n),y:v,text:s(n)}}),{fontSize:c,tickLength:d}),n.restore()}function yt(n,t,r){var e=1<arguments.length&&void 0!==t?t:10,o=2<arguments.length&&void 0!==r?r:T,r=(t=n,r=o,Math.min.apply(Math,D(t.map(r)))),n=(n=n,o=o,Math.max.apply(Math,D(n.map(o)))),o=x(r,n,e),r=l(r,o),n=f(n,o),o=x(r,n,e),e=M(r,n,e);return Array.from(new Set([l(r,o)].concat(D(e),[f(n,o)])))}var ht=["type"];function pt(n){if("function"==typeof n)return n;var o,i,t,r,e,a,u,c=n.type,f=W(n,ht);if("interval"===c)return zn;if("line"===c)return Ln;if("area"===c)return En;if("text"===c)return Dn;if("link"===c)return Rn;if("cell"===c)return Pn;if("rect"===c)return In;if("point"===c)return Wn;if("path"===c)return Tn;if("facet"===c){var l=function(){};return l.channels=function(){return{x:{name:"x",optional:!0},y:{name:"y",optional:!0}}},l}if("stackY"===c)return function(n){var t,r=n.index,e=n.values,o=e.y,i=e.x,n=i?Array.from(P(r,function(n){return i[n]}).values()):[r],a=new Array(r.length),u=new Array(r.length),c=R(n);try{for(c.s();!(t=c.n()).done;)for(var f=t.value,l=0,d=0;d<f.length;l=a[f[d]],d+=1){var s=f[d];u[s]=l,a[s]=l+o[s]}}catch(n){c.e(n)}finally{c.f()}return{index:r,values:C(C({},e),{},{y:a,y1:u})}};if("normalizeY"===c)return function(n){var t,r=n.index,e=n.values,o=e.x,n=o?Array.from(P(r,function(n){return o[n]}).values()):[r],i=Object.fromEntries(["y1","y"].filter(function(n){return e[n]}).map(function(n){return[n,new Array(r.length)]})),a=R(n);try{for(a.s();!(t=a.n()).done;){var u,c=t.value,f=c.flatMap(function(t){return Object.keys(i).map(function(n){return e[n][t]})}),l=Math.max.apply(Math,D(f)),d=R(c);try{for(d.s();!(u=d.n()).done;)for(var s=u.value,v=0,y=Object.keys(i);v<y.length;v++){var h=y[v];i[h][s]=e[h][s]/l}}catch(n){d.e(n)}finally{d.f()}}}catch(n){a.e(n)}finally{a.f()}return{index:r,values:C(C({},e),i)}};if("symmetryY"===c)return function(n){for(var t=n.index,r=n.values,e=r.x,n=e?Array.from(P(t,function(n){return e[n]}).values()):[t],o=Object.fromEntries(["y1","y"].filter(function(n){return r[n]}).map(function(n){return[n,new Array(t.length)]})),i=new Array(n.length),a=0,u=Object.entries(n);a<u.length;a++){var c=E(u[a],2),f=c[0],l=c[1].flatMap(function(t){return Object.keys(o).map(function(n){return r[n][t]})}),c=Math.min.apply(Math,D(l)),l=Math.max.apply(Math,D(l));i[f]=(c+l)/2}for(var d=Math.max.apply(Math,i),s=0,v=Object.entries(n);s<v.length;s++){var y,h=E(v[s],2),p=h[0],h=h[1],g=d-i[p],m=R(h);try{for(m.s();!(y=m.n()).done;)for(var x=y.value,b=0,w=Object.keys(o);b<w.length;b++){var k=w[b];o[k][x]=r[k][x]+g}}catch(n){m.e(n)}finally{m.f()}}return{index:t,values:C(C({},r),o)}};if("binX"===c)return function(n){var t=0<arguments.length&&void 0!==n?n:{},n=t.count,c=void 0===n?10:n,f=t.channel,l=void 0===(t=t.aggregate)?function(n){return n.length}:t;return function(n){var t=n.index,r=n.values;r[f];var e=r.x;r.x1;var o=W(r,[f,"x","x1"].map(d)),n=Object.keys(o),i=yt(e,c),o=i.length,a=P(t,function(n){return O(i,e[n])-1}),u=new Array(o-1).fill(0).map(function(n,t){return t});return{index:u.filter(function(n){return a.has(n)}),values:Object.fromEntries([].concat(D(n.map(function(t){return[t,u.map(function(n){if(a.has(n))return r[t][a.get(n)[0]]})]})),[[f,u.map(function(n){return a.has(n)?l(a.get(n).map(function(n){return r[n]})):0})],["x",i.slice(0,o-1)],["x1",i.slice(1,o)]]))}}}(f);if("cartesian"===c)return en(f);if("transpose"===c)return an(f);if("polar"===c)return on(f);if("band"===c)return Nn(f);if("linear"===c)return mt(Fn,f);if("time"===c)return mt($n,f);if("log"===c)return mt(Hn,f);if("identity"===c)return function(n){return n};if("ordinal"===c)return Bn(f);if("dot"===c)return Nn(C(C({},f),{},{padding:1}));if("quantile"===c)return a=(t=f).domain,r=t.range,e=W(t,Un),t=r.length-1,o=a.sort(function(n,t){return n-t}),i=(o.length-1)/(1+t),Zn(C({domain:new Array(t).fill(0).map(function(n,t){var r=(t+1)*i,e=Math.floor(r),t=e+1;return o[e]*(t-r)+o[t]*(r-e)}),range:r},e));if("quantize"===c)return t=(a=E((l=f).domain,2))[0],r=a[1],e=l.range,a=W(l,_n),l=e.length-1,u=(r-t)/(1+l),Zn(C({domain:new Array(l).fill(0).map(function(n,t){return u*(t+1)}),range:e},a));if("threshold"===c)return Zn(f);if("axisX"===c)return gt(lt,f);if("axisY"===c)return gt(dt,f);if("legendSwatches"===c)return gt(st,f);if("legendRamp"===c)return gt(vt,f);throw new Error("Unknown node type: ".concat(n.type))}function gt(e,o){return function(n,t,r){return e(n,t,r,o)}}function mt(n,t){var r=t.nice,e=void 0===r||r,r=t.tickCount,r=void 0===r?10:r,t=n(t);return e&&t.nice(r),t}var xt=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],bt=["#9DF5CA","#61DDAA","#42C090","#19A576","#008A5D"],wt=["domain"];function kt(n,t){var r,e,o,i,a,u,c,f={},l=R(P(n.flatMap(Object.entries),function(n){return At(E(n,1)[0])}));try{for(l.s();!(r=l.n()).done;){var d=E(r.value,2),s=d[0],v=function(n,t){var r,e,o,i=[],a=R(t);try{for(a.s();!(o=a.n()).done;){var u=E(o.value,2)[1],c=u.values,f=void 0===c?[]:c,l=u.scale,d=u.field;i.push.apply(i,D(f)),!r&&l&&(r=l),!e&&d&&(e=d)}}catch(n){a.e(n)}finally{a.f()}return{name:n,scale:r,values:i,field:e}}(s,d[1]),y=t[s]||{},h=(o=y,c=u=a=i=void 0,i=(e=v).name,a=e.scale,u=e.values,c=y.type,e=y.domain,o=y.range,a||c||(2<(e||o||[]).length?Mt(i):void 0===e?Ot(u)?Mt(i):St(u)?"time":function(n){return 1===Array.from(new Set(n)).length}(u)?"identity":"linear":Ot(e)?Mt(i):St(e)?"time":"linear"));f[s]=C(C(C({},y),function(n,t,r){var e=t.name,o=r.padding,i=r.interpolate,a=r.margin;switch(n){case"linear":case"log":return i?{interpolate:i}:{interpolate:"color"===e?Xn:Yn};case"band":return{padding:void 0!==o?o:.1};case"dot":return{margin:void 0!==a?a:.5};default:return{}}}(h,v,y)),{},{domain:function(n,t,r){var e=t.values,t=r.domain,o=W(r,wt);if(t)return t;switch(n){case"linear":case"log":case"quantize":return jt(e,o);case"ordinal":case"dot":case"band":return zt(e);case"quantile":return function(n){return zt(n).sort()}(e);case"time":return function(n,t){return jt(n,t).map(function(n){return new Date(n)})}(e,o);default:return[]}}(h,v,y),range:function(n,t,r){var e=t.name,r=r.range;if(r)return r;switch(n){case"linear":case"log":case"time":case"band":case"dot":return function(n){return"y"===n?[1,0]:"color"===n?[bt[0],S(bt)]:[0,1]}(e);case"ordinal":return xt;case"quantile":case"quantize":case"threshold":return bt;default:return[]}}(h,v,y),label:function(n,t){n=n.field,t=t.label;return void 0!==t?t:n}(v,y),type:h})}}catch(n){l.e(n)}finally{l.f()}return f}function At(n){return n.startsWith("x")?"x":n.startsWith("y")?"y":"fill"===(t=n)||"stroke"===t?"color":n;var t}function Mt(n){return"x"===(n=n)||"y"===n?"dot":"ordinal"}function Ot(n){return n.some(function(n){n=t(n);return"string"===n||"value"===n})}function St(n){return n.some(function(n){return n instanceof Date})}function jt(n,t){var r=(1<arguments.length&&void 0!==t?t:{}).zero,t=void 0!==r&&r,r=n.filter(y);if(0===r.length)return[];n=Math.min.apply(Math,D(r));return[t?0:n,Math.max.apply(Math,D(r))]}function zt(n){return Array.from(new Set(n.filter(y)))}var Pt=["fill"],It=["stroke"],Lt=["y1"],Ct=["x1"],Wt=["y"],Et=["x"],Dt=["x","x1"],Rt=["fill","stroke","z"];function Tt(n,r,t){var e,o,i,a,u=X(t,function(n,t){return{type:function(n,t,r){if("function"==typeof t)return"transform";if("string"==typeof t){if(n.length&&void 0!==n[0][t])return"field";if(function(n){return"fill"===n||"stroke"===n}(r))return"constant"}return"value"}(r,n,t),value:n}});switch(n){case"interval":return Yt((i=qt(u),a=void 0===(a=i.x)?Zt():a,i=W(i,Et),C({x:a},i)));case"line":return Xt(Bt(u));case"area":return Yt(Ft(qt(Bt(u))));case"link":return Xt(Ft(u));case"point":return e=Xt(u),o=void 0===(o=e.y)?Zt():o,e=W(e,Wt),C({y:o},e);case"rect":return Yt((o=qt(u),e=void 0===(e=o.x1)?Zt():e,o=W(o,Ct),C({x1:e},o)));case"cell":return Yt(u)}return u}function Yt(n){var t=n.fill;return C({fill:void 0===t?Ut():t},W(n,Pt))}function Xt(n){var t=n.stroke;return C({stroke:void 0===t?Ut():t},W(n,It))}function qt(n){var t=n.y1;return C({y1:void 0===t?Zt():t},W(n,Lt))}function Ft(n){var t=n.x,r=n.x1;return C({x:t,x1:void 0===r?t:r},W(n,Dt))}function Bt(n){var t=n.fill,r=n.stroke,e=n.z,n=W(n,Rt);return C({fill:t,stroke:r,z:e=void 0===(e=void 0===e?Nt(t):e)?Nt(r):e},n)}function Nt(n){if(void 0!==n&&"field"===n.type)return n}function Zt(){return{type:"value",value:0}}function Ut(){return{type:"constant",value:xt[0]}}function _t(n){for(var t=n.data,r=n.type,e=n.encodings,o=void 0===e?{}:e,i=n.statistics,e=void 0===i?[]:i,i=n.transforms,i=void 0===i?[]:i,n=n.styles,a=Y.apply(void 0,D(i.map(pt)))(t),t=a.map(function(n,t){return t}),u=Tt(r,a,o),c={},f={},l=0,d=Object.entries(u);l<d.length;l++){var s,v=E(d[l],2),y=v[0],h=v[1];h&&(s=h.type,v=h.value,"constant"===s?c[y]=v:f[y]=function(n,t){var r=t.type,e=t.value;return"transform"===r?n.map(e):"value"===r?n.map(function(){return e}):n.map(function(n){return n[e]})}(a,h))}for(var t=Y.apply(void 0,D(e.map(pt)))({index:t,values:f}),p=t.values,t=t.index,r=pt({type:r}),g={},m=0,x=Object.entries(r.channels());m<x.length;m++){var b=E(x[m],2),w=b[0],k=b[1],A=p[w],b=k.optional;if(A)g[w]=function(n,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},e=r.type,r=r.value;return C(C(C({},n),"field"===e&&{field:r}),{},{values:t})}(k,A,u[w]);else if(!b)throw new Error("Missing values for channel: ".concat(w))}return{index:t,geometry:r,channels:g,styles:C(C({},n),c)}}function Jt(n,t,r){var e=n.x,o=n.y,i=n.color,a=r.x,u=void 0===a?{}:a,c=r.y,f=void 0===c?{}:c,n=r.color,a=void 0===n?{}:n,c=u.display,r=f.display,n=void 0===r||r,r=a.display,r=void 0===r||r;return C(C(C({},(void 0===c||c)&&e&&{x:C(C({},$t(u,e)),{},{type:"axisX"})}),n&&o&&{y:C(C({},$t(f,o)),{},{type:"axisY"})}),r&&i&&{color:C(C(C({},$t(a,i)),(r=(o=t).x,a=t.y,o=t.paddingLeft,{x:r+o,y:a})),{},{type:function(n){switch(n.type){case"linear":case"log":case"time":case"threshold":case"quantile":case"quantize":return"legendRamp";default:return"legendSwatches"}}(i)})})}function $t(n,t){var r=t.domain,t=t.label;return C(C({},n),{},{domain:r,label:t})}var Gt=["transform"],Ht=["scales","guides","coordinates","transforms","paddingLeft","paddingRight","paddingBottom","paddingTop"],Kt=["type","children"];function Qt(n){switch(n){case"layer":case"col":case"row":return!1;default:return!0}}n.plot=function(n){var t=n.width,r=n.height,e=Q(void 0===t?640:t,void 0===r?480:r,n.renderer);F(n,function(n){var t=n.type,r=n.children,e=W(n,Kt);if(!Qt(t)&&r&&0!==r.length){var o,i=["o:encodings","o:scales","o:guides","o:styles","a:coordinates","a:statistics","a:transforms","a:data"],a=R(r);try{for(a.s();!(o=a.n()).done;){var u,c=o.value,f=R(i);try{for(f.s();!(u=f.n()).done;){var l=E(u.value.split(":"),2),d=l[0],s=l[1];c[s]="o"===d?C(C({},e[s]),c[s]):c[s]||e[s]}}catch(n){f.e(n)}finally{f.f()}}}catch(n){a.e(n)}finally{a.f()}}});var o,i=R(N(n));try{for(i.s();!(o=i.n()).done;){var a,u=E(o.value,2),c=u[0],f=u[1],l=c.transform,d=void 0===l?T:l,s=W(c,Gt),v=[],y={},h={},p=[],g=R(f.filter(function(n){return Qt(n.type)}));try{for(g.s();!(a=g.n()).done;){var m=a.value,x=m.scales,b=void 0===x?{}:x,w=m.guides,k=void 0===w?{}:w,A=m.coordinates,M=void 0===A?[]:A,O=m.transforms,S=void 0===O?[]:O,j=m.paddingLeft,z=m.paddingRight,P=m.paddingBottom,I=m.paddingTop,L=W(m,Ht);q(y,b),q(h,k),q(s,{paddingLeft:j,paddingRight:z,paddingBottom:P,paddingTop:I}),M&&(p=M),v.push(C(C({},L),{},{transforms:[d].concat(D(S))}))}}catch(n){g.e(n)}finally{g.f()}!function(n){for(var t=n.renderer,r=n.scales,e=n.guides,o=n.coordinates,i=n.geometries,a=n.width,u=n.height,c=n.x,f=n.y,l=n.paddingLeft,d=void 0===l?45:l,s=n.paddingRight,l=void 0===s?45:s,s=n.paddingBottom,s=void 0===s?45:s,n=n.paddingTop,n=void 0===n?65:n,i=i.map(_t),r=kt(i.map(function(n){return n.channels}),r),e=Jt(r,{x:c,y:f,paddingLeft:d},e),v=X(r,pt),e=X(e,pt),o=function(n){return[].concat(D(n),[{type:"cartesian"}])}(o).map(pt),y=function(n){var t=void 0===(t=n.transforms)?[]:t,r=W(n,V),e=(t=t.flatMap(function(n){return n(r)})).map(function(n){return n.type()}),t=Y.apply(void 0,D(t)),o=r.x,i=r.y,a=r.width,u=r.height;return t.isPolar=function(){return-1!==e.indexOf("polar")},t.isTranspose=function(){return e.reduce(function(n,t){return n^"transpose"===t},!1)},t.center=function(){return[o+a/2,i+u/2]},t}({x:c+d,y:f+n,width:a-d-l,height:u-n-s,transforms:o}),h=0,p=Object.entries(e);h<p.length;h++){var g=E(p[h],2),m=g[0],g=g[1],m=v[m];g(t,m,y)}var x,b=R(i);try{for(b.s();!(x=b.n()).done;){var w=x.value,k=w.index,A=w.geometry,M=w.channels,O=w.styles,S=function(n,r){return X(n,function(n){var t=n.values,n=n.name,n=r[At(n)];return t.map(n)})}(M,v);A(t,k,v,S,O,y)}}catch(n){b.e(n)}finally{b.f()}}(C({renderer:e,scales:y,guides:h,geometries:v,coordinates:p},s))}}catch(n){i.e(n)}finally{i.f()}return e.node()},Object.defineProperty(n,"__esModule",{value:!0})});
