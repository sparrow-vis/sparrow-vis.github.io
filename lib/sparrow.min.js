!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((n="undefined"!=typeof globalThis?globalThis:n||self).sp={})}(this,function(e){"use strict";function o(t,n){var r,e=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,r)),e}function an(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?o(Object(r),!0).forEach(function(n){g(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function i(n){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function g(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function un(n,t){if(null==n)return{};var r,e=function(n,t){if(null==n)return{};for(var r,e={},o=Object.keys(n),i=0;i<o.length;i++)r=o[i],0<=t.indexOf(r)||(e[r]=n[r]);return e}(n,t);if(Object.getOwnPropertySymbols)for(var o=Object.getOwnPropertySymbols(n),i=0;i<o.length;i++)r=o[i],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(n,r)&&(e[r]=n[r]);return e}function cn(n,t){return a(n)||function(n,t){var r=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=r){var e,o,i=[],a=!0,u=!1;try{for(r=r.call(n);!(a=(e=r.next()).done)&&(i.push(e.value),!t||i.length!==t);a=!0);}catch(n){u=!0,o=n}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}}(n,t)||c(n,t)||l()}function fn(n){return function(n){if(Array.isArray(n))return f(n)}(n)||u(n)||c(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(n){if(Array.isArray(n))return n}function u(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}function c(n,t){if(n){if("string"==typeof n)return f(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);return"Map"===(r="Object"===r&&n.constructor?n.constructor.name:r)||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(n,t):void 0}}function f(n,t){(null==t||t>n.length)&&(t=n.length);for(var r=0,e=new Array(t);r<t;r++)e[r]=n[r];return e}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ln(n,t){var r,e="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!e){if(Array.isArray(n)||(e=c(n))||t&&n&&"number"==typeof n.length)return e&&(n=e),r=0,{s:t=function(){},n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){e=e.call(n)},n:function(){var n=e.next();return i=n.done,n},e:function(n){a=!0,o=n},f:function(){try{i||null==e.return||e.return()}finally{if(a)throw o}}}}function s(n){n=function(n,t){if("object"!=typeof n||null===n)return n;var r=n[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(n);if("object"!=typeof(r=r.call(n,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(n,"string");return"symbol"==typeof n?n:String(n)}function P(n,t){for(var r,l=t.type,e=t.children,o=t.flex,o=void 0===o?e.map(function(){return 1}):o,t=t.padding,i=void 0===t?40:t,t=cn("col"===l?["y","height","width","x"]:["x","width","height","y"],4),a=t[0],u=t[1],d=t[2],s=t[3],v=o.reduce(function(n,t){return n+t}),y=n[u]-i*(e.length-1),c=o.map(function(n){return n/v*y}),h=[],p=n[a],f=0;f<c.length;p+=c[f]+i,f+=1)h.push((g(r={},a,p),g(r,u,c[f]),g(r,s,n[s]),g(r,d,n[d]),r));return h}function dn(n){return n}function sn(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return t.reduce(function(t,r){return function(n){return r(t(n))}},dn)}function d(i){var a=i.length;return function n(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];var o=0===r.length?[void 0]:r;return o.length>=a?i.apply(void 0,fn(o)):n.bind.apply(n,[null].concat(fn(o)))}}function v(n,t){return t*Math.ceil(n/t)}function y(n,t){return t*Math.floor(n/t)}function h(n,t){return Math.log(n)/Math.log(t)}function p(n,t){var n=cn(n,2),r=n[0],n=n[1];return[t.floor(r),t.ceil(n)]}function vn(n,t){var e=1<arguments.length&&void 0!==t?t:dn;return Object.entries(n).reduce(function(n,t){var t=cn(t,2),r=t[0],t=t[1];return n[r]=e(t,r),n},{})}function yn(n,t){for(var r=0,e=Object.entries(t);r<e.length;r++){var o=cn(e[r],2),i=o[0],o=o[1];void 0!==o&&(n[i]=o)}}function m(n){return void 0!==n&&!Number.isNaN(n)}function x(n,t){var n=cn(n,2),r=n[0],n=n[1],t=cn(t,2),e=t[0],t=t[1];return b(r,e)&&b(n,t)}function b(n,t,r){r=2<arguments.length&&void 0!==r?r:1e-5;return Math.abs(n-t)<r}function w(n,t){var n=cn(n,2),r=n[0],n=n[1],t=cn(1<arguments.length&&void 0!==t?t:[],2),e=t[0],t=t[1],t=void 0===t?0:t;return Math.sqrt(Math.pow(r-(void 0===e?0:e),2)+Math.pow(n-t,2))}function k(n,t){var n=cn(n,2),r=n[0],n=n[1],t=cn(t,2);return[r-t[0],n-t[1]]}function A(n){var n=cn(n,2),t=n[0],n=n[1];return Math.atan2(n,t)}function M(n){return 180*n/Math.PI}function O(t,n,r){var e=1<arguments.length&&void 0!==n?n:function(n){return n[0]},o=2<arguments.length&&void 0!==r?r:function(n){return n[1]};return t.filter(function(r,n){return t.findIndex(function(n){return n=n,b(e(t=r),e(n))&&b(o(t),o(n));var t})===n})}function z(n,t){var r,e=1<arguments.length&&void 0!==t?t:function(n){return n},o=new Map,i=ln(n);try{for(i.s();!(r=i.n()).done;){var a=r.value,u=e(a),c=o.get(u);c?c.push(a):o.set(u,[a])}}catch(n){i.e(n)}finally{i.f()}return o}function S(n,t,r){var e=Math.sqrt(50),o=Math.sqrt(10),i=Math.sqrt(2),t=Math.abs(t-n)/Math.max(0,r),n=Math.pow(10,Math.floor(Math.log(t)/Math.LN10)),r=t/n;return e<=r?n*=10:o<=r?n*=5:i<=r&&(n*=2),n}function j(n,t,r){if(n===t)return[n];for(var e,o=S(n,t,r),i=Math.ceil(n/o),r=Math.floor(t/o),a=Math.ceil(r-i+1),u=new Array(a),c=0;c<a;c+=1)u[c]=(e=(i+c)*o,Math.round(1e12*e)/1e12);return u}function I(n,t,r,e,o){for(var r=2<arguments.length&&void 0!==r?r:0,e=3<arguments.length&&void 0!==e?e:n.length,i=4<arguments.length&&void 0!==o?o:dn,a=r,u=e;a<u;){var c=a+u>>>1;i(n[c])<t?a=1+c:u=c}return a}function L(n){return n[n.length-1]}function hn(n,t){for(var r=[n];r.length;){var e=r.pop();t(e),r.push.apply(r,fn(e.children||[]))}}function C(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function W(n,t){n&&n.appendChild(t)}function E(e,n){for(var t=n.data,r=n.encodings,r=void 0===r?{}:r,o=n.padding,i=void 0===o?0:o,o=n.paddingLeft,l=void 0===o?45:o,o=n.paddingRight,d=void 0===o?45:o,o=n.paddingBottom,o=void 0===o?45:o,n=n.paddingTop,n=void 0===n?60:n,a=r.x,u=r.y,c=a?Array.from(z(t,function(n){return n[a]}).keys()):[void 0],f=u?Array.from(z(t,function(n){return n[u]}).keys()):[void 0],s=c.length,v=f.length,y=[],r=e.width-l-d,t=e.height-n-o,h=(r-i*(s-1))/s,p=(t-i*(v-1))/v,g=function(r){for(var n=function(t){y.push({x:l+e.x+i*r+r*h,y:d+e.y+i*t+t*p,width:h,height:p,transform:function(n){return n.filter(function(n){return(n[a]===c[r]||void 0===c[r])&&(n[u]===f[t]||void 0===f[t])})}})},t=0;t<v;t+=1)n(t)},m=0;m<s;m+=1)g(m);return y}function D(n,t){t=t.children;return new Array((void 0===t?[]:t).length).fill(0).map(function(){return an({},n)})}function pn(n,t){var r,l,d=1<arguments.length&&void 0!==t?t:{layer:D,col:P,row:P,facet:E},t=(r=[],hn(n,function(n){return r.push(n)}),r),s=n.width,v=n.height,y=n.x,h=n.y,e=new Map([[n,{width:void 0===s?640:s,height:void 0===v?480:v,x:void 0===y?0:y,y:void 0===h?0:h}]]),o=ln(t);try{for(o.s();!(l=o.n()).done;){var i=l.value,p=e.get(i),g=i.children,m=void 0===g?[]:g,a=d[i.type];if(a){var x=a(p,i);if(a!==E)for(var u=0,b=Object.entries(m);u<b.length;u++){var w=cn(b[u],2),k=w[0],A=w[1];e.set(A,x[k])}else{var M,c=ln(m);try{for(c.s();!(M=c.n()).done;){var O,S=M.value,f=ln(x);try{for(f.s();!(O=f.n()).done;){var j=O.value;e.set(an({},S),j)}}catch(n){f.e(n)}finally{f.f()}}}catch(n){c.e(n)}finally{c.f()}}}}}catch(n){o.e(n)}finally{o.f()}n=z(Array.from(e.entries()),function(n){var n=cn(n,2)[1];return"".concat((n=n).x,"-").concat(n.y,"-").concat(n.width,"-").concat(n.height)});return Array.from(n.values()).map(function(n){return[n[0][1],n.map(function(n){return n[0]})]})}var R=["text"];function T(n,t){return B("line",n,t)}function Y(n,t){var r=t.width,e=t.height,o=t.x,i=t.y;return B("rect",n,an(an({},t),{},{width:Math.abs(r),height:Math.abs(e),x:0<r?o:o+r,y:0<e?i:i+e}))}function X(n,t){var r=t.d,r=Array.isArray(r)?r.flat().join(" "):r;return B("path",n,an(an({},t),{},{d:r}))}function q(n,t){return B("circle",n,t)}function F(n,t){var r=t.text,n=B("text",n,un(t,R));return n.textContent=r,n}function B(n,t,r){for(var t=t.group,n=C(n),e=n,o=0,i=Object.entries(r);o<i.length;o++){var a=cn(i[o],2),u=a[0],a=a[1],u=u.replace(/[A-Z]/g,function(n){return"-".concat(n.toLocaleLowerCase())});e.setAttribute(u,a)}return W(t,n),n}function N(n,t){for(var r,t=t.group,e=arguments.length,o=new Array(2<e?e-2:0),i=2;i<e;i++)o[i-2]=arguments[i];t=t,n="".concat(n,"(").concat(o.join(", "),")"),r=(r=t.getAttribute("transform")||"")?"".concat(r," "):"",t.setAttribute("transform","".concat(r).concat(n))}function gn(n,t,r){var r=2<arguments.length&&void 0!==r?r:{},e=r.line,o=void 0===e?T:e,e=r.circle,i=void 0===e?q:e,e=r.text,a=void 0===e?F:e,e=r.rect,u=void 0===e?Y:e,e=r.path,f=void 0===e?X:e,e=r.context,c=(void 0===e?function(n){return n}:e)((r=n,e=t,(n=C("svg")).setAttribute("width",r),n.setAttribute("height",e),n.setAttribute("viewBox","0 0 ".concat(r," ").concat(e)),r=C("g"),W(n,r),{node:n,group:r}));return{line:function(n){return o(c,n)},circle:function(n){return i(c,n)},text:function(n){return a(c,n)},rect:function(n){return u(c,n)},path:function(n){return f(c,n)},restore:function(){var n,t;t=(n=c).group.parentNode,n.group=t},save:function(){return t=(n=c).group,r=C("g"),W(t,r),void(n.group=r);var n,t,r},scale:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return function(n,t,r){N("scale",n,t,r)}.apply(void 0,[c].concat(t))},rotate:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return function(n,t){N("rotate",n,t)}.apply(void 0,[c].concat(t))},translate:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return function(n,t,r){N("translate",n,t,r)}.apply(void 0,[c].concat(t))},node:function(){return c.node},group:function(){return c.group}}}var mn=["transforms"];function Z(n,t){var r=0<arguments.length&&void 0!==n?n:0,e=1<arguments.length&&void 0!==t?t:0;return _("translate",function(n){var n=cn(n,2),t=n[0],n=n[1];return[t+r,n+e]})}function U(n,t){var r=0<arguments.length&&void 0!==n?n:1,e=1<arguments.length&&void 0!==t?t:1;return _("scale",function(n){var n=cn(n,2),t=n[0],n=n[1];return[t*r,n*e]})}function _(n,t){return t.type=function(){return n},t}var J=d(function(n,t){var r=t.x,e=t.y;return[U(t.width,t.height),Z(r,e)]});var $=d(function(n,t){var r=t.width,t=t.height,e=void 0===(e=n.innerRadius)?0:e,o=void 0===(o=n.outerRadius)?1:o,i=void 0===(i=n.startAngle)?-Math.PI/2:i,n=void 0===(n=n.endAngle)?Math.PI/2*3:n,t=1<(r=r/t)?1/r:1,r=1<r?1:r;return[Z(0,-.5),_("reflectY",U(1,-1)),Z(0,.5),U(n-i,o-e),Z(i,e),_("polar",function(n){var n=cn(n,2),t=n[0],n=n[1];return[n*Math.cos(t),n*Math.sin(t)]}),U(t,r),U(.5,.5),Z(.5,.5)]});var G=d(function(n,t){return[_("transpose",function(n){var n=cn(n,2),t=n[0];return[n[1],t]}),Z(-.5,-.5),_("reflectX",U(-1,1)),Z(.5,.5)]}),H=["name","optional"];function t(n){var t=n.name,r=n.optional;return an({name:t,optional:void 0===r||r},un(n,H))}function n(n){n=0<arguments.length&&void 0!==n?n:{};return an({x:t({name:"x",optional:!1}),y:t({name:"y",optional:!1}),stroke:t({name:"stroke"}),fill:t({name:"fill"})},n)}function K(n,t){var r=t.stroke,t=t.fill;return an(an({},r&&{stroke:r[n]}),t&&{fill:t[n]})}function Q(n,t){return K(cn(n,1)[0],t)}function V(n){var n=a(n=n)||u(n)||c(n)||l(),t=n[0],n=n.slice(1);return[["M"].concat(fn(t))].concat(fn(n.map(function(n){return["L"].concat(fn(n))})))}function nn(n){return[].concat(fn(V(n)),[["Z"]])}function tn(n){var n=cn(n,5),t=n[0],r=n[1],e=n[2],o=n[3],n=n[4],i=w(t,r),a=w(t,o),u=(u=k(r,t),t=k(e,t),u=A(u),t=A(t),u<t?t-u:2*Math.PI-(u-t)),t=u>Math.PI?1:0,u=u>Math.PI?1:0;return[["M",r[0],r[1]],["A",i,i,0,t,1,e[0],e[1]],["L",o[0],o[1]],["A",a,a,0,u,0,n[0],n[1]],["Z"]]}var rn=["cx","cy","r1","r2"],en=["points"];function on(n,t){var r,e,o,i,a,l,u=t.cx,c=t.cy,d=t.r1,s=t.r2,t=un(t,rn),f=n.path(an(an({},t),{},{d:(e=(r=cn(r=[[u,c],[d,s]],2))[0],o=(r=cn(r[1],2))[0],r=r[1],i=(f=cn(e,2))[0],f=f[1],[].concat(fn(tn([e,a=[i,f-r],r=[i,f+r],l=[i,f+o],i=[i,f-o]])),fn(tn([e,r,a,i,l])))),stroke:"none"}));return[n.circle(an(an({},t),{},{fill:"none",r:d,cx:u,cy:c})),f,n.circle(an(an({},t),{},{fill:"none",r:s,cx:u,cy:c}))]}var xn=["x1","y1","x2","y2"],bn=["cx","cy","r"],wn=["X","Y","I"],kn=["X1","Y1","X2","Y2","I"],An=["x","y","rotate","text"],Mn=["x1","y1","x2","y2"];function On(l,n,t){var r=t.x1,e=t.y1,o=t.x2,i=t.y2,t=un(t,xn),a=[r,e],e=[o,e],o=[o,i],r=[r,i],i=(n.isTranspose()?[r,a,e,o]:[a,e,o,r]).map(n),a=cn(i,4),e=a[0],o=a[1],r=a[2],a=a[3];if(!n.isPolar())return d=(f=cn(k(r,e),2))[0],f=f[1],u=(c=cn(e,2))[0],c=c[1],l.rect(an({x:u,y:c,width:d,height:f},t));var u=n.center(),c=cn(u,2),d=c[0],f=c[1];return x(e,o)&&x(r,a)?on(l,an({cx:d,cy:f,r1:w(u,r),r2:w(u,e)},t)):l.path(an({d:tn([u].concat(fn(i)))},t))}function Sn(n,t,r){var e,o,i,a,u,c,l=r.X1,d=r.Y1,s=r.X2,v=r.Y2,f=r.I,r=un(r,kn),f=t.isPolar()?[].concat(fn(f),[f[0]]):f,f=[].concat(fn(f.map(function(n){return[l[n],d[n]]})),fn(f.map(function(n){return[s[n],v[n]]}).reverse())).map(t);return t.isPolar()?(t=n,e=an({points:f},r),o=e.points,e=un(e,en),i=o.length,a=i/2,u=t.path(an(an({d:nn(o)},e),{},{stroke:"none"})),c=t.path(an(an({d:V(o.slice(0,a))},e),{},{fill:"none"})),[t.path(an(an({d:V(o.slice(a,i))},e),{},{fill:"none"})),u,c]):n.path(an({d:nn(f)},r))}function r(d,s){function n(n,t,r,e,o,i){for(var a=0,u=Object.entries(d);a<u.length;a++){var c=cn(u[a],2),f=c[0],c=c[1],l=c.optional,c=c.scale;if(!l){if(!e[f])throw new Error("Missing Channel: ".concat(f));if(!("band"!==c||r[f]&&r[f].bandWidth))throw new Error("".concat(f," channel needs band scale."))}}return s(n,t,r,e,o,i)}return n.channels=function(){return d},n}var jn=["z","x"];var zn=r(n({x:t({name:"x",scale:"band",optional:!1}),z:t({name:"z",scale:"band"}),y1:t({name:"y1",optional:!1})}),function(o,n,t,i,a,u){var c={z:0,x:0},r=t.x,t=t.z,l=i.x,d=i.y,s=i.y1,v=void 0===(e=i.z)?[]:e,f=r.bandWidth(),e=t&&t.bandWidth?t.bandWidth():1,y=f*e;return Array.from(n,function(n){var t=c.z,r=c.x,e=un(c,jn),t=(v[n]||t)*f,r=(l[n]||r)+t;return On(o,u,an(an(an(an({},e),a),K(n,i)),{},{x1:r,y1:d[n],x2:r+y,y2:s[n]}))})});var Pn=r(n({x:t({name:"x",scale:"band",optional:!1}),y:t({name:"y",scale:"band",optional:!1})}),function(t,n,r,e,o,i){var a={},u=r.x,r=r.y,c=e.x,f=e.y,l=u.bandWidth(),d=r.bandWidth();return Array.from(n,function(n){return On(t,i,an(an(an(an({},a),o),K(n,e)),{},{x1:c[n],y1:f[n],x2:c[n]+l,y2:f[n]+d}))})});var In=r(n({x1:t({name:"x1",optional:!1}),y1:t({name:"y1",optional:!1})}),function(t,n,l,r,e,o){var i={},a=r.x,u=r.y,c=r.x1,f=r.y1;return Array.from(n,function(n){return On(t,o,an(an(an(an({},i),e),K(n,r)),{},{x1:a[n],y1:u[n],x2:c[n],y2:f[n]}))})});var Ln=r(n({z:t({name:"z"})}),function(a,n,r,u,c,f){var l={},d=u.x,s=u.y,t=u.z,n=t?z(n,function(n){return t[n]}).values():[n];return Array.from(n,function(n){return t=a,r=f,n=an(an(an(an({},l),c),Q(n,u)),{},{X:d,Y:s,I:n,fill:"none"}),e=n.X,o=n.Y,i=n.I,n=un(n,wn),i=V((r.isPolar()?[].concat(fn(i),[i[0]]):i).map(function(n){return r([e[n],o[n]])})),t.path(an({d:i},n));var t,r,e,o,i})}),Cn=["r"];var Wn=r(n({r:t({name:"r"})}),function(a,n,r,u,c,f){var l={r:3,fill:"none"},d=u.x,s=u.y,t=u.r,v=void 0===t?[]:t;return Array.from(n,function(n){var t,r,e,o=l.r,i=un(l,Cn),o=v[n]||o;return t=a,r=f,i=an(an(an(an({},i),c),K(n,u)),{},{cx:d[n],cy:s[n],r:o}),n=i.cx,o=i.cy,e=i.r,i=un(i,bn),n=(r=cn(r([n,o]),2))[0],o=r[1],t.circle(an({cx:n,cy:o,r:e},i))})});var En=r(n({x1:t({name:"x1",optional:!1}),y1:t({name:"y1",optional:!1}),z:t({name:"z"})}),function(t,n,l,r,e,o){var i={},a=r.x,u=r.y,c=r.z,f=r.x1,d=r.y1,n=c?z(n,function(n){return c[n]}).values():[n];return Array.from(n,function(n){return Sn(t,o,an(an(an(an({},i),e),Q(n,r)),{},{X1:a,Y1:u,X2:f,Y2:d,I:n}))})});var Dn=r(n({rotate:t({name:"rotate"}),fontSize:t({name:"fontSize"}),fontWeight:t({name:"fontWeight"}),text:t({name:"text",optional:!1,scale:"identity"})}),function(u,n,r,c,f,l){var d=0,s=14,v="normal",y=c.x,h=c.y,p=c.text,t=c.rotate,g=void 0===t?[]:t,m=void 0===(t=c.fontSize)?[]:t,x=void 0===(t=c.fontWeight)?[]:t;return Array.from(n,function(n){return t=u,r=l,n=an(an(an({},f),K(n,c)),{},{x:y[n],y:h[n],rotate:g[n]||d,fontSize:m[n]||s,fontWeight:x[n]||v,text:p[n]}),e=n.x,o=n.y,i=n.rotate,a=n.text,n=un(n,An),e=(r=cn(r([e,o]),2))[0],o=r[1],t.save(),t.translate(e,o),t.rotate(i),r=t.text(an({text:a,x:0,y:0},n)),t.restore(),r;var t,r,e,o,i,a})});var Rn=r(n({x1:t({name:"x1",optional:!1}),y1:t({name:"y1",optional:!1})}),function(u,n,t,c,f,l){var d={},s=c.x,v=c.y,y=c.x1,h=c.y1;return Array.from(n,function(n){return t=u,r=l,n=an(an(an(an({},d),f),K(n,c)),{},{x1:s[n],y1:v[n],x2:y[n],y2:h[n]}),e=n.x1,o=n.y1,i=n.x2,a=n.y2,n=un(n,Mn),o=(e=cn([[e,o],[i,a]].map(r),2))[0],i=e[1],t.line(an({x1:o[0],y1:o[1],x2:i[0],y2:i[1]},n));var t,r,e,o,i,a})});var Tn=r({d:t({name:"d",optional:!1,scale:"identity"}),fill:t({name:"fill"}),stroke:t({name:"stroke"})},function(r,n,t,e,o,i){var a={},u=e.d;return Array.from(n,function(n){return t=r,n=an(an(an(an({},a),o),K(n,e)),{},{d:u[n]}),t.path(n);var t})});function Yn(n,t,r){return t*(1-n)+r*n}function Xn(n,t,r){var t=cn(qn(t),3),e=t[0],o=t[1],t=t[2],r=cn(qn(r),3),i=r[0],a=r[1],r=r[2],e=Yn(n,e,i),i=Yn(n,o,a),o=Yn(n,t,r),a=parseInt(e),n=parseInt(i),t=parseInt(o);return a=(a<<16|n<<8|t).toString(16),"#".concat(new Array(Math.abs(a.length-7)).join("0")).concat(a)}function qn(n){for(var t=[],r=1;r<7;r+=2)t.push(parseInt("0x".concat(n.slice(r,r+2))));return t}function Fn(n){function t(n){return u((n-e)/(o-e),i,a)}var r=cn(n.domain,2),e=r[0],o=r[1],r=cn(n.range,2),i=r[0],a=r[1],r=n.interpolate,u=void 0===r?Yn:r;return t.ticks=function(){return j(e,o,0<arguments.length&&void 0!==arguments[0]?arguments[0]:10)},t.nice=function(){var t,n;e!==o&&(t=S(e,o,0<arguments.length&&void 0!==arguments[0]?arguments[0]:10),n=cn(p([e,o],{floor:function(n){return y(n,t)},ceil:function(n){return v(n,t)}}),2),e=n[0],o=n[1])},t}function Bn(n){var t=n.domain,r=n.range,e=JSON.stringify,o=new Map(t.map(function(n,t){return[e(n),t]}));return function(n){n=o.get(e(n));return r[n%r.length]}}function Nn(n){i=(t=n).domain,a=t.range,f=t.padding,t=t.margin,r=void 0===t?f:t,t=cn(a,2),e=t[0],a=t[1],t=i.length;var t,r,e,o,i={step:o=(a-e)/(2*r+t-f),bandWidth:o*(1-f),bandRange:new Array(t).fill(0).map(function(n,t){return e+r*o+o*t})},a=i.bandRange,u=i.bandWidth,c=i.step,f=Bn(an(an({},n),{},{range:a}));return f.bandWidth=function(){return u},f.step=function(){return c},f}function Zn(n){function t(n){return n=I(r,n),e[-1===n?o:n]}var r=n.domain,e=n.range,o=Math.min(r.length,e.length-1);return t.thresholds=function(){return r},t}var Un=["domain","range"];var _n=["domain","range"];var Jn=["domain"];function $n(n){function t(n){return n.getTime()}function r(n){return o(t(n))}var e=n.domain,n=un(n,Jn),o=Fn(an({domain:e.map(t)},n));return r.nice=function(n){return o.nice(n)},r.ticks=function(n){return o.ticks(n).map(function(n){return new Date(n)})},r}var Gn=["domain","base"];function Hn(n){function t(n){return Math.log(n)}function r(n){return u(t(n))}var e=n.domain,o=n.base,i=void 0===o?Math.E:o,a=un(n,Gn),u=Fn(an({domain:e.map(t)},a));return r.ticks=function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:5,t=cn(e.map(function(n){return h(n,i)}),2);return j(t[0],t[1],n).map(function(n){return Math.pow(i,n)})},r.nice=function(){e=p(e,{floor:function(n){return Math.pow(i,Math.floor(h(n,i)))},ceil:function(n){return Math.pow(i,Math.ceil(h(n,i)))}}),u=Fn(an({domain:e.map(t)},a))},r}function Kn(m){return function(n,r,e,t){var o,l,d,i,s,v,a,y,u=t.domain,h=t.label,c=t.tickCount,c=void 0===c?10:c,f=t.formatter,p=void 0===f?dn:f,f=t.tickLength,f=void 0===f?5:f,g=t.grid,g=void 0!==g&&g,t=t.tick,t=void 0===t||t;0!==u.length&&(o=!!r.bandWidth,i=!!r.ticks,l=o?r.bandWidth()/2:0,d=i?r.ticks(c):u,i=e.center(),c="".concat(+e.isPolar()).concat(+e.isTranspose()),u={tickLength:f,fontSize:10,center:i,isOrdinal:o},i=(f=m[c]).grid,c=f.ticks,s=f.label,v=f.start,f=f.end,a=d.map(function(n){var t=cn(e(v(n,r,l)),2);return{x:t[0],y:t[1],text:p(n)}}),y=function(){if(!o)return L(a);var n=L(d),n=cn(e(v(n,r,2*l)),2);return{x:n[0],y:n[1]}}(),g&&i&&i(n,a,f(e)),t&&c&&c(n,a,u),h&&s&&s(n,h,y,u))}}function Qn(n,t,r){var e,o=r.tickLength,l=r.fontSize,i=ln(t);try{for(i.s();!(e=i.n()).done;){var a=e.value,u=a.x,c=a.y,d=a.text,f=c+o;n.line({x1:u,y1:c,x2:u,y2:f,stroke:"currentColor",class:"tick"}),n.text({text:d,fontSize:l,x:u,y:f,textAnchor:"middle",dy:"1em",class:"text"})}}catch(n){i.e(n)}finally{i.f()}}function Vn(n,t,r){var e,o=r.tickLength,l=r.fontSize,i=ln(t);try{for(i.s();!(e=i.n()).done;){var a=e.value,u=a.x,c=a.y,d=a.text,f=u-o;n.line({x1:u,y1:c,x2:f,y2:c,stroke:"currentColor",class:"tick"}),n.text({text:d,fontSize:l,x:f,y:c,textAnchor:"end",dy:"0.5em",dx:"-0.5em",class:"text"})}}catch(n){i.e(n)}finally{i.f()}}function nt(n,l,t){var r,e,o,i,d=t.tickLength,s=t.fontSize,v=t.center,a=ln(O(l,function(n){return n.x},function(n){return n.y}));try{for(a.s();!(r=a.n()).done;){var u=r.value,c=u.x,f=u.y,y=u.text,h=(e=v,void 0,i=void 0,o=cn(o=[c,f],2),i=o[0],o=o[1],i=A(k([i,o],e)),o=i<0?Math.PI:0,{tickRotation:i-Math.PI/2,textRotation:o}),p=h.tickRotation,g=h.textRotation,m=d,x=0===g?"1.2em":"-0.5em";n.save(),n.translate(c,f),n.rotate(M(p)),n.line({x1:0,y1:0,x2:0,y2:m,stroke:"currentColor",fill:"currentColor",class:"tick"}),n.save(),n.translate(0,m),n.rotate(M(g)),n.text({text:"".concat(y),x:0,y:0,textAnchor:"middle",fontSize:s,fill:"currentColor",dy:x,class:"text"}),n.restore(),n.restore()}}catch(n){a.e(n)}finally{a.f()}}function tt(n,t,r){var e,o=cn(r,2)[1],i=ln(t);try{for(i.s();!(e=i.n()).done;){var a=e.value,u=a.x,c=a.y;n.line({x1:u,y1:c,x2:u,y2:o,stroke:"#eee",class:"grid"})}}catch(n){i.e(n)}finally{i.f()}}function rt(n,t,r){var e,o=cn(r,1)[0],i=ln(t);try{for(i.s();!(e=i.n()).done;){var a=e.value,u=a.x,c=a.y;n.line({x1:u,y1:c,x2:o,y2:c,stroke:"#eee",class:"grid"})}}catch(n){i.e(n)}finally{i.f()}}function et(n,t,r){var e,r=cn(r,2),o=r[0],i=r[1],a=ln(t);try{for(a.s();!(e=a.n()).done;){var u=e.value,c=u.x,f=u.y;n.line({x1:c,y1:f,x2:o,y2:i,stroke:"#eee",class:"grid"})}}catch(n){a.e(n)}finally{a.f()}}function ot(n,t,r){var e,o=cn(r,2),i=o[0],a=o[1],u=ln(t);try{for(u.s();!(e=u.n()).done;){var c=e.value,f=w(r,[c.x,c.y]);n.circle({fill:"none",stroke:"#eee",cx:i,cy:a,r:f,class:"grid"})}}catch(n){u.e(n)}finally{u.f()}}var it=["isOrdinal"],at=["isOrdinal"],ut=["isOrdinal","tickLength"],ct=["isOrdinal","tickLength"];function ft(n){return{textAnchor:"end",class:"label",fontWeight:"bold",fontSize:n.fontSize}}var lt=Kn({"00":{start:function(n,t,r){return[t(n)+r,1]},end:function(n){return n([0,0])},grid:tt,ticks:Qn,label:function(n,t,r,e){var o=r.x,r=r.y,i=e.isOrdinal,a=e.tickLength,e=un(e,ut),r=r+a,a=i?t:"".concat(t," →");n.text(an(an({},ft(e)),{},{text:a,x:o,y:r,dy:"2.2em"}))}},"01":{start:function(n,t,r){return[t(n)+r,1]},end:function(n){return n([0,0])},grid:rt,ticks:Vn,label:function(n,t,r,e){var o=r.x,r=r.y,i=e.isOrdinal,e=un(e,at),i=i?t:"↓ ".concat(t);n.text(an(an({},ft(e)),{},{text:i,x:o,y:r,dy:"2.2em"}))}},10:{start:function(n,t,r){return[t(n)+r,0]},grid:et,ticks:nt,end:function(n){return n.center()}},11:{start:function(n,t,r){return[t(n)+r,1]},grid:ot,ticks:Vn,end:function(n){return n.center()}}}),dt=Kn({"00":{start:function(n,t,r){return[0,t(n)+r]},end:function(n){return n([1,0])},grid:rt,ticks:Vn,label:function(n,t,r,e){var o=r.x,r=r.y,i=e.isOrdinal,e=un(e,it),i=i?t:"↑ ".concat(t);n.text(an(an({},ft(e)),{},{text:i,x:o,y:r,dy:"-1em"}))}},"01":{start:function(n,t,r){return[0,t(n)+r]},end:function(n){return n([1,0])},grid:tt,ticks:function(n,t,r){var e,o=r.tickLength,l=r.fontSize,i=ln(t);try{for(i.s();!(e=i.n()).done;){var a=e.value,u=a.x,c=a.y,d=a.text,f=c-o;n.line({x1:u,y1:c,x2:u,y2:f,stroke:"currentColor",class:"tick"}),n.text({text:d,fontSize:l,x:u,y:f,textAnchor:"middle",dy:"-0.3em",class:"text"})}}catch(n){i.e(n)}finally{i.f()}},label:function(n,t,r,e){var o=r.x,r=r.y,i=e.isOrdinal,a=e.tickLength,e=un(e,ct),r=r-a,a=i?t:"".concat(t," →");n.text(an(an({},ft(e)),{},{text:a,x:o,y:r,dy:"-1.2em"}))}},10:{start:function(n,t,r){return[0,t(n)+r]},grid:ot,ticks:Vn,end:function(n){return n.center()}},11:{start:function(n,t,r){return[0,t(n)+r]},grid:et,ticks:nt,end:function(n){return n.center()}}});function st(n,l,d,t){for(var s=t.x,v=t.y,r=t.width,y=void 0===r?64:r,r=t.marginLeft,h=void 0===r?6:r,r=t.swatchSize,e=void 0===r?10:r,r=t.fontSize,o=void 0===r?10:r,r=t.formatter,p=void 0===r?dn:r,r=t.domain,t=t.label,i=(n.save(),n.translate(s,v),t&&n.text({text:t,x:0,y:0,fontWeight:"bold",fontSize:o,textAnchor:"start",dy:"1em"}),t?2*e:0),a=0,g=Object.entries(r);a<g.length;a++){var u=cn(g[a],2),c=u[0],u=u[1],f=l(u),c=y*c,f=(n.rect({x:c,y:i,width:e,height:e,stroke:f,fill:f}),c+h+e),c=i+e;n.text({text:p(u),x:f,y:c,fill:"currentColor",fontSize:o})}n.restore()}function vt(n,t,l,r){for(var e=r.x,d=r.y,o=r.width,i=void 0===o?120:o,o=r.height,a=void 0===o?10:o,o=r.domain,u=r.tickCount,u=void 0===u?5:u,s=r.tickLength,s=void 0===s?a+5:s,c=r.formatter,v=void 0===c?dn:c,c=r.fontSize,c=void 0===c?10:c,r=r.label,y=(n.save(),n.translate(e,d),r&&n.text({text:r,x:0,y:0,fontWeight:"bold",fontSize:c,textAnchor:"start",dy:"1em"}),r?2*a:0),e=[o[0],L(o)],h=Fn({domain:[0,i],range:e}),f=0;f<i;f+=1){var p=t(h(f));n.line({x1:f,y1:y,x2:f,y2:y+a,stroke:p})}var g=Fn({domain:e,range:[0,i]});Qn(n,(t.thresholds?[e[0]].concat(fn(t.thresholds()),[e[1]]):g.ticks(u)).map(function(n){return{x:g(n),y:y,text:v(n)}}),{fontSize:c,tickLength:s}),n.restore()}function yt(n,t,r){var t=1<arguments.length&&void 0!==t?t:10,r=2<arguments.length&&void 0!==r?r:dn,e=(e=n,o=r,Math.min.apply(Math,fn(e.map(o)))),r=(o=n,n=r,Math.max.apply(Math,fn(o.map(n)))),o=S(e,r,t),n=y(e,o),e=v(r,o),r=S(n,e,t),o=j(n,e,t);return Array.from(new Set([y(n,r)].concat(fn(o),[v(e,r)])))}var ht=["type"];function pt(n){if("function"==typeof n)return n;var t,o,l,r,e,i,a,u,d,c=n.type,f=un(n,ht);if("interval"===c)return zn;if("line"===c)return Ln;if("area"===c)return En;if("text"===c)return Dn;if("link"===c)return Rn;if("cell"===c)return Pn;if("rect"===c)return In;if("point"===c)return Wn;if("path"===c)return Tn;if("facet"===c)return(t=function(){}).channels=function(){return{x:{name:"x",optional:!0},y:{name:"y",optional:!0}}},t;if("stackY"===c)return function(n){var t,r=n.index,n=n.values,l=n.y,e=n.x,d=e?Array.from(z(r,function(n){return e[n]}).values()):[r],o=new Array(r.length),s=new Array(r.length),i=ln(d);try{for(i.s();!(t=i.n()).done;)for(var a=t.value,u=0,c=0;c<a.length;u=o[a[c]],c+=1){var f=a[c];s[f]=u,o[f]=u+l[f]}}catch(n){i.e(n)}finally{i.f()}return{index:r,values:an(an({},n),{},{y:o,y1:s})}};if("normalizeY"===c)return function(n){var t,r=n.index,e=n.values,o=e.x,n=o?Array.from(z(r,function(n){return o[n]}).values()):[r],i=Object.fromEntries(["y1","y"].filter(function(n){return e[n]}).map(function(n){return[n,new Array(r.length)]})),a=ln(n);try{for(a.s();!(t=a.n()).done;){var u,l=t.value,d=l.flatMap(function(t){return Object.keys(i).map(function(n){return e[n][t]})}),s=Math.max.apply(Math,fn(d)),c=ln(l);try{for(c.s();!(u=c.n()).done;)for(var v=u.value,f=0,y=Object.keys(i);f<y.length;f++){var h=y[f];i[h][v]=e[h][v]/s}}catch(n){c.e(n)}finally{c.f()}}}catch(n){a.e(n)}finally{a.f()}return{index:r,values:an(an({},e),i)}};if("symmetryY"===c)return function(n){for(var t=n.index,r=n.values,l=r.x,n=l?Array.from(z(t,function(n){return l[n]}).values()):[t],e=Object.fromEntries(["y1","y"].filter(function(n){return r[n]}).map(function(n){return[n,new Array(t.length)]})),o=new Array(n.length),i=0,d=Object.entries(n);i<d.length;i++){var a=cn(d[i],2),s=a[0],a=a[1].flatMap(function(t){return Object.keys(e).map(function(n){return r[n][t]})}),v=Math.min.apply(Math,fn(a)),a=Math.max.apply(Math,fn(a));o[s]=(v+a)/2}for(var y=Math.max.apply(Math,o),u=0,h=Object.entries(n);u<h.length;u++){var p,c=cn(h[u],2),g=c[0],c=c[1],m=y-o[g],f=ln(c);try{for(f.s();!(p=f.n()).done;)for(var x=p.value,b=0,w=Object.keys(e);b<w.length;b++){var k=w[b];e[k][x]=r[k][x]+m}}catch(n){f.e(n)}finally{f.f()}}return{index:t,values:an(an({},r),e)}};if("binX"===c)return function(n){var n=0<arguments.length&&void 0!==n?n:{},t=n.count,c=void 0===t?10:t,f=n.channel,l=void 0===(t=n.aggregate)?function(n){return n.length}:t;return function(n){var t=n.index,r=n.values,e=(r[f],r.x),n=(r.x1,un(r,[f,"x","x1"].map(s))),n=Object.keys(n),o=yt(e,c),i=o.length,a=z(t,function(n){return I(o,e[n])-1}),u=new Array(i-1).fill(0).map(function(n,t){return t});return{index:u.filter(function(n){return a.has(n)}),values:Object.fromEntries([].concat(fn(n.map(function(t){return[t,u.map(function(n){if(a.has(n))return r[t][a.get(n)[0]]})]})),[[f,u.map(function(n){return a.has(n)?l(a.get(n).map(function(n){return r[n]})):0})],["x",o.slice(0,i-1)],["x1",o.slice(1,i)]]))}}}(f);if("cartesian"===c)return J(f);if("transpose"===c)return G(f);if("polar"===c)return $(f);if("band"===c)return Nn(f);if("linear"===c)return mt(Fn,f);if("time"===c)return mt($n,f);if("log"===c)return mt(Hn,f);if("identity"===c)return function(n){return n};if("ordinal"===c)return Bn(f);if("dot"===c)return Nn(an(an({},f),{},{padding:1}));if("quantile"===c)return r=(t=f).domain,e=f.range,t=un(f,Un),i=e.length-1,o=r.sort(function(n,t){return n-t}),l=(o.length-1)/(1+i),Zn(an({domain:new Array(i).fill(0).map(function(n,t){var t=(t+1)*l,r=Math.floor(t),e=r+1;return o[r]*(e-t)+o[e]*(t-r)}),range:e},t));if("quantize"===c)return e=(i=cn((r=f).domain,2))[0],i=i[1],a=r.range,r=un(r,_n),u=a.length-1,d=(i-e)/(1+u),Zn(an({domain:new Array(u).fill(0).map(function(n,t){return d*(t+1)}),range:a},r));if("threshold"===c)return Zn(f);if("axisX"===c)return gt(lt,f);if("axisY"===c)return gt(dt,f);if("legendSwatches"===c)return gt(st,f);if("legendRamp"===c)return gt(vt,f);throw new Error("Unknown node type: ".concat(n.type))}function gt(e,o){return function(n,t,r){return e(n,t,r,o)}}function mt(n,t){var r=t.nice,r=void 0===r||r,e=t.tickCount,e=void 0===e?10:e,n=n(t);return r&&n.nice(e),n}var xt=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],bt=["#9DF5CA","#61DDAA","#42C090","#19A576","#008A5D"],wt=["domain"];function kt(l,d){var s,n,t,r,e,o,i,v={},a=ln(z(l.flatMap(Object.entries),function(n){return At(cn(n,1)[0])}));try{for(a.s();!(s=a.n()).done;){var y=cn(s.value,2),h=y[0],u=function(n,l){var t,r,e,o=[],i=ln(l);try{for(i.s();!(e=i.n()).done;){var a=cn(e.value,2)[1],u=a.values,d=void 0===u?[]:u,c=a.scale,f=a.field;o.push.apply(o,fn(d)),!t&&c&&(t=c),!r&&f&&(r=f)}}catch(n){i.e(n)}finally{i.f()}return{name:n,scale:t,values:o,field:r}}(h,y[1]),c=d[h]||{},f=(t=c,i=o=e=r=void 0,r=(n=u).name,e=n.scale,n=n.values,o=c.type,i=c.domain,t=c.range,e||o||(2<(i||t||[]).length?Mt(r):void 0===i?Ot(n)?Mt(r):St(n)?"time":function(n){return 1===Array.from(new Set(n)).length}(n)?"identity":"linear":Ot(i)?Mt(r):St(i)?"time":"linear"));v[h]=an(an(an({},c),function(n,t,r){var e=t.name,o=r.padding,i=r.interpolate,a=r.margin;switch(n){case"linear":case"log":return i?{interpolate:i}:{interpolate:"color"===e?Xn:Yn};case"band":return{padding:void 0!==o?o:.1};case"dot":return{margin:void 0!==a?a:.5};default:return{}}}(f,u,c)),{},{domain:function(n,t,r){var e=t.values,t=r.domain,o=un(r,wt);if(t)return t;switch(n){case"linear":case"log":case"quantize":return jt(e,o);case"ordinal":case"dot":case"band":return zt(e);case"quantile":return function(n){return zt(n).sort()}(e);case"time":return function(n,t){return jt(n,t).map(function(n){return new Date(n)})}(e,o);default:return[]}}(f,u,c),range:function(n,t,r){var e=t.name,t=r.range;if(t)return t;switch(n){case"linear":case"log":case"time":case"band":case"dot":return function(n){return"y"===n?[1,0]:"color"===n?[bt[0],L(bt)]:[0,1]}(e);case"ordinal":return xt;case"quantile":case"quantize":case"threshold":return bt;default:return[]}}(f,u,c),label:function(n,t){n=n.field,t=t.label;return void 0!==t?t:n}(u,c),type:f})}}catch(n){a.e(n)}finally{a.f()}return v}function At(n){return n.startsWith("x")?"x":n.startsWith("y")?"y":"fill"===(t=n)||"stroke"===t?"color":n;var t}function Mt(n){return"x"===(n=n)||"y"===n?"dot":"ordinal"}function Ot(n){return n.some(function(n){n=i(n);return"string"===n||"value"===n})}function St(n){return n.some(function(n){return n instanceof Date})}function jt(n,t){t=(1<arguments.length&&void 0!==t?t:{}).zero,t=void 0!==t&&t,n=n.filter(m);if(0===n.length)return[];var r=Math.min.apply(Math,fn(n));return[t?0:r,Math.max.apply(Math,fn(n))]}function zt(n){return Array.from(new Set(n.filter(m)))}var Pt=["fill"],It=["stroke"],Lt=["y1"],Ct=["x1"],Wt=["y"],Et=["x"],Dt=["x","x1"],Rt=["fill","stroke","z"];function Tt(n,r,t){var e,o,i,a,u=vn(t,function(n,t){return{type:function(n,t,r){if("function"==typeof t)return"transform";if("string"==typeof t){if(n.length&&void 0!==n[0][t])return"field";if(function(n){return"fill"===n||"stroke"===n}(r))return"constant"}return"value"}(r,n,t),value:n}});switch(n){case"interval":return Yt((i=qt(u),a=void 0===(a=i.x)?Zt():a,i=un(i,Et),an({x:a},i)));case"line":return Xt(Bt(u));case"area":return Yt(Ft(qt(Bt(u))));case"link":return Xt(Ft(u));case"point":return a=Xt(u),i=void 0===(i=a.y)?Zt():i,a=un(a,Wt),an({y:i},a);case"rect":return Yt((e=qt(u),o=void 0===(o=e.x1)?Zt():o,e=un(e,Ct),an({x1:o},e)));case"cell":return Yt(u)}return u}function Yt(n){var t=n.fill;return an({fill:void 0===t?Ut():t},un(n,Pt))}function Xt(n){var t=n.stroke;return an({stroke:void 0===t?Ut():t},un(n,It))}function qt(n){var t=n.y1;return an({y1:void 0===t?Zt():t},un(n,Lt))}function Ft(n){var t=n.x,r=n.x1;return an({x:t,x1:void 0===r?t:r},un(n,Dt))}function Bt(n){var t=n.fill,r=n.stroke,e=n.z,n=un(n,Rt);return an({fill:t,stroke:r,z:e=void 0===(e=void 0===e?Nt(t):e)?Nt(r):e},n)}function Nt(n){if(void 0!==n&&"field"===n.type)return n}function Zt(){return{type:"value",value:0}}function Ut(){return{type:"constant",value:xt[0]}}function _t(n){for(var t=n.data,l=n.type,r=n.encodings,r=void 0===r?{}:r,e=n.statistics,e=void 0===e?[]:e,o=n.transforms,o=void 0===o?[]:o,n=n.styles,i=sn.apply(void 0,fn(o.map(pt)))(t),o=i.map(function(n,t){return t}),d=Tt(l,i,r),s={},v={},a=0,y=Object.entries(d);a<y.length;a++){var h,p,u=cn(y[a],2),g=u[0],u=u[1];u&&(h=u.type,p=u.value,"constant"===h?s[g]=p:v[g]=function(n,t){var r=t.type,e=t.value;return"transform"===r?n.map(e):"value"===r?n.map(function(){return e}):n.map(function(n){return n[e]})}(i,u))}for(var t=sn.apply(void 0,fn(e.map(pt)))({index:o,values:v}),m=t.values,r=t.index,e=pt({type:l}),x={},b=0,w=Object.entries(e.channels());b<w.length;b++){var c=cn(w[b],2),f=c[0],c=c[1],k=m[f],A=c.optional;if(k)x[f]=function(n,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},e=r.type,r=r.value;return an(an(an({},n),"field"===e&&{field:r}),{},{values:t})}(c,k,d[f]);else if(!A)throw new Error("Missing values for channel: ".concat(f))}return{index:r,geometry:e,channels:x,styles:an(an({},n),s)}}function Jt(n,t,r){var e=n.x,o=n.y,n=n.color,i=r.x,i=void 0===i?{}:i,a=r.y,a=void 0===a?{}:a,r=r.color,r=void 0===r?{}:r,u=i.display,c=a.display,c=void 0===c||c,f=r.display,f=void 0===f||f;return an(an(an({},(void 0===u||u)&&e&&{x:an(an({},$t(i,e)),{},{type:"axisX"})}),c&&o&&{y:an(an({},$t(a,o)),{},{type:"axisY"})}),f&&n&&{color:an(an(an({},$t(r,n)),(i=(u=t).x,e=t.y,u=t.paddingLeft,{x:i+u,y:e})),{},{type:function(n){switch(n.type){case"linear":case"log":case"time":case"threshold":case"quantile":case"quantize":return"legendRamp";default:return"legendSwatches"}}(n)})})}function $t(n,t){var r=t.domain,t=t.label;return an(an({},n),{},{domain:r,label:t})}var Gt=["transform"],Ht=["scales","guides","coordinates","transforms","paddingLeft","paddingRight","paddingBottom","paddingTop"],Kt=["type","children"];function Qt(n){switch(n){case"layer":case"col":case"row":return!1;default:return!0}}e.plot=function(n){var l,d=n.width,s=n.height,v=gn(void 0===d?640:d,void 0===s?480:s,n.renderer),d=(hn(n,function(n){var l=n.type,t=n.children,r=un(n,Kt);if(!Qt(l)&&t&&0!==t.length){var e,d=["o:encodings","o:scales","o:guides","o:styles","a:coordinates","a:statistics","a:transforms","a:data"],o=ln(t);try{for(o.s();!(e=o.n()).done;){var i,a=e.value,u=ln(d);try{for(u.s();!(i=u.n()).done;){var c=cn(i.value.split(":"),2),s=c[0],f=c[1];a[f]="o"===s?an(an({},r[f]),a[f]):a[f]||r[f]}}catch(n){u.e(n)}finally{u.f()}}}catch(n){o.e(n)}finally{o.f()}}}),pn(n)),y=ln(d);try{for(y.s();!(l=y.n()).done;){var h,p=cn(l.value,2),g=p[0],m=p[1],x=g.transform,b=void 0===x?dn:x,w=un(g,Gt),k=[],A={},M={},O=[],S=ln(m.filter(function(n){return Qt(n.type)}));try{for(S.s();!(h=S.n()).done;){var t=h.value,j=t.scales,z=void 0===j?{}:j,P=t.guides,I=void 0===P?{}:P,L=t.coordinates,C=void 0===L?[]:L,W=t.transforms,E=void 0===W?[]:W,D=t.paddingLeft,R=t.paddingRight,T=t.paddingBottom,Y=t.paddingTop,X=un(t,Ht);yn(A,z),yn(M,I),yn(w,{paddingLeft:D,paddingRight:R,paddingBottom:T,paddingTop:Y}),C&&(O=C),k.push(an(an({},X),{},{transforms:[b].concat(fn(E))}))}}catch(n){S.e(n)}finally{S.f()}on=en=rn=tn=nn=V=K=Q=H=f=H=f=G=$=J=e=r=_=e=r=o=c=c=u=u=a=a=i=i=U=Z=N=B=o=F=e=r=q=c=void 0;for(var q=(c=an({renderer:v,scales:A,guides:M,geometries:k,coordinates:O},w)).renderer,r=c.scales,e=c.guides,F=c.coordinates,o=c.geometries,B=c.width,N=c.height,Z=c.x,U=c.y,i=void 0===(i=c.paddingLeft)?45:i,a=void 0===(a=c.paddingRight)?45:a,u=void 0===(u=c.paddingBottom)?45:u,c=void 0===(c=c.paddingTop)?65:c,o=o.map(_t),e=Jt(r=kt(o.map(function(n){return n.channels}),r),{x:Z,y:U,paddingLeft:i},e),_=vn(r,pt),r=vn(e,pt),e=function(n){return[].concat(fn(n),[{type:"cartesian"}])}(F).map(pt),J=function(n){var t=void 0===(t=n.transforms)?[]:t,r=un(n,mn),e=(n=t.flatMap(function(n){return n(r)})).map(function(n){return n.type()}),t=sn.apply(void 0,fn(n)),o=r.x,i=r.y,a=r.width,u=r.height;return t.isPolar=function(){return-1!==e.indexOf("polar")},t.isTranspose=function(){return e.reduce(function(n,t){return n^"transpose"===t},!1)},t.center=function(){return[o+a/2,i+u/2]},t}({x:Z+i,y:U+c,width:B-i-a,height:N-c-u,transforms:e}),$=0,G=Object.entries(r);$<G.length;$++){var f=cn(G[$],2),H=f[0],f=f[1],H=_[H];f(q,H,J)}var K,Q=ln(o);try{for(Q.s();!(K=Q.n()).done;){var V=K.value,nn=V.index,tn=V.geometry,rn=V.channels,en=V.styles,on=function(n,r){return vn(n,function(n){var t=n.values,n=n.name,n=r[At(n)];return t.map(n)})}(rn,_);tn(q,nn,_,on,en,J)}}catch(n){Q.e(n)}finally{Q.f()}}}catch(n){y.e(n)}finally{y.f()}return v.node()},Object.defineProperty(e,"__esModule",{value:!0})});
